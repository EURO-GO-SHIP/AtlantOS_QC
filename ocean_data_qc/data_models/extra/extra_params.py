import numpy as np
import pandas as pd

class ExtraParams():
    def __init__(self):
        pass
    
    def to_numpy_array(self, data):
        if data is None:
            return None
        if isinstance(data, pd.Series):
            return data.to_numpy()
        return np.atleast_1d(data)

    def aou_gg(self, S, T, OXY):

        S = self.to_numpy_array(S)
        T = self.to_numpy_array(T)
        OXY = self.to_numpy_array(OXY)

        # Constants for Eqn of Garcia and Gordon 1992 in umol/kgsw
        A0 = 5.80871
        A1 = 3.20291
        A2 = 4.17887
        A3 = 5.10006
        A4 = -9.86643E-02
        A5 = 3.80369
        B0 = -7.01577E-03
        B1 = -7.70028E-03
        B2 = -1.13864E-02
        B3 = -9.51519E-03
        C0 = -2.75915E-07

        # Equation calculation
        Ts = np.log((298.15 - T) / (273.15 + T))
        lnC0 = (A0 + A1 * Ts + A2 * Ts**2 + A3 * Ts**3 + A4 * Ts**4 + A5 * Ts**5 +
                S * (B0 + B1 * Ts + B2 * Ts**2 + B3 * Ts**3) +
                C0 * S**2)

        c = np.exp(lnC0)
        c = c - OXY
        return c

    def mapminmax_apply(self, x1, x1_step1_xoffset, x1_step1_gain, x1_step1_ymin):
        y = x1 - x1_step1_xoffset[:, np.newaxis]
        y *= x1_step1_gain[:, np.newaxis]
        y += x1_step1_ymin
        return y

    def tansig_apply(self, n):
        return 2 / (1 + np.exp(-2 * n)) - 1

    def mapminmax_reverse(self, y, y1_step1_xoffset, y1_step1_gain, y1_step1_ymin):
        x = (y - y1_step1_ymin) / y1_step1_gain
        x += y1_step1_xoffset
        return x

    def alkali_nng2_vel13(self,LONGITUDE, LATITUDE, DPTH, THETA, SAL, NITRAT, PHSPHT, SILCAT, OXY):
        LONGITUDE = self.to_numpy_array(LONGITUDE)
        LATITUDE = self.to_numpy_array(LATITUDE)
        DPTH = self.to_numpy_array(DPTH)
        THETA = self.to_numpy_array(THETA)
        SAL = self.to_numpy_array(SAL)
        NITRAT = self.to_numpy_array(NITRAT)
        PHSPHT = self.to_numpy_array(PHSPHT)
        SILCAT = self.to_numpy_array(SILCAT)
        OXY = self.to_numpy_array(OXY)

        LONGITUDE = np.mod(LONGITUDE + 180, 360) - 180
        DPTH = -1 * DPTH

        x1 = np.vstack((LONGITUDE, LATITUDE, DPTH, THETA, SAL, NITRAT, PHSPHT, SILCAT, OXY))
        samples=x1.shape[1]

        # ===== NEURAL NETWORK CONSTANTS =====
        # Input 1
        x1_step1_xoffset = np.array([-179.988,-78.638,0,-2.18999374712659,32,0,0,0,0])
        x1_step1_gain = np.array([0.00555574074691379,0.0118597231940607,0.000266427808795185,0.0582080345370401,0.232207128758853,0.0396691353384097,0.112324926377178,0.00805941301515655,0.0019476093095725]).T
        x1_step1_ymin = -1
        # Layer 1
        b1 = np.array([-0.92409777024623218633,26.38817429377832724,57.950805996110737794,-56.291305529739737779,-82.132041633109579948,1.6645572528330363493,-5.2269197136311404961,-46.3809029608363943,36.703986856197793998,-5.0586227115039719138,5.0659031161226257822,-5.8084594929569766109,-101.80195755007419223,-11.480396410799986739,39.7412025338207755,-84.248055998779278752,45.489817845532023455,-173.38958319303867484,20.634217428673732542,-1.1701786336691295531,-111.01960201482185653,-7.6682904656909132157,-139.02188947007408615,-64.664840186397071875,-32.189870204459964498,2.8889804435221035916,-2.0435632413340933944,-77.296621333775888729,12.185866365698981184,-19.074051454297769936,-34.827628383474653617,-3.7205445207340503977,-4.4516363029425685127,-3.8578647810421178299,-30.176619537462105569,15.966197621395737727,-4.7294505681430800692,-61.675548977441955856,78.826492958597839333,107.38052104508098239,-25.764970874028211512,128.16606214837264588,-21.114106541519852556,-10.238766455560588398,-4.8115158199303857955,-20.905349430181573211,40.610915060270166066,4.5420828453359529675,18.65997273306744475,4.5690333138333301122,-45.331963370437385663,9.5873759436681353918,60.681208064689144521,-39.338531830053241833,2.7344676051406726636,26.872496764941416814,34.106195264069846473,92.710942322712412533,51.353186850530200047,-11.168674448774771335,-36.458228622094658533,-9.3462389215204701998,7.7601749120290195449,101.34221145658329988]).T
        IW1_1 = np.array([20.931836698419889586,72.747359066133228112,-89.684002394681755277,-13.016120982885313495,-49.853454363400921068,-59.505015300720835114,8.5718823699590380727,101.37769222326437557,47.553210855387206379,5.8296968322669489027,1.4600937992218341321,-1.288523091154225142,1.1830167005263727553,15.968264181783819566,-0.75757314808635844994,22.3954791785572489,3.6937689732280420962,10.587282878995806001,13.764696862323578586,-2.1138797674689548955,4.6364935346493583168,14.124927407237404253,26.608510949775535437,-2.3964116758292237641,40.836666509029484473,-3.1644436042264643127,4.0435200210759489892,5.1063060536691580182,-1.3471997328889266932,2.5256299132383768224,-3.8100312072829378707,6.6237508177425103995,6.4164258092724599791,-62.815363984667968111,1.6754902326389295997,-7.8969975596575867627,-1.3606103148529793412,-20.566262312592229478,-15.29784505497434921,33.763996694029216883,-12.433797492452312028,44.199080991550161457,-158.58881677673306854,21.592537554520635723,46.204380742360278589,-3.2915405626589371302,-1.7324644036061551677,0.47561529031071403395,-1.6051985715715777481,-0.57668377840614049035,-2.2990237210439548043,1.7149445306395483257,4.0515039281422202677,-1.0568555991748893597,-1.7570980930809909637,0.61267154361709652566,-0.18582298050982695714,-1.7831085120312455405,-0.67263133728440294146,-0.91319133801254348537,-3.3588172741586799219,0.47813969493332592053,-1.6730921241736993466,-15.006426965363704795,3.0698305451903245,-110.69998874942682221,-36.500815918934698345,68.971406270578555109,47.51388654578123294,0.58434747927572427972,12.196008572734431397,0.037942369568419606618,-7.0735580016212660226,10.699747841265740078,-14.513402721465714862,27.694991403164394228,69.313894402096039471,57.518790680227006362,-95.267041482982989464,10.561743983588456786,108.27932020012930536,0.016347251566432689091,0.81043563131820461898,-0.009032564129030563882,0.10746555222907776261,-1.1275716248288845112,1.8771822182132427148,-3.7875530848616594248,-0.32829422441073302652,-4.3161533546022301522,1.7617713141387645326,-0.59546980586343911668,0.18929427090193148842,1.8015482769053803302,0.62630222607603314167,0.95498069678058905563,3.122124362095447303,-0.45184202984170268591,1.6871962126632822354,0.15843372805944966331,2.9940652741824789196,-1.3309721698840695225,-6.0133017338635443849,-14.779594405059096829,-12.759029441569424534,22.688049753647973716,-1.3150893099512941387,-17.947770276516436638,-34.403544347308560702,-12.813442361536479197,39.151295008334720649,-4.3824371906834551638,-2.3493571970133291238,-28.392061412468859061,-121.36925414098826081,-1.8543652192549391344,-53.926933762703313846,-0.74399418001502426456,-3.9425391866267736063,1.3540093131698429652,-5.5248664126105317962,16.375069142594405491,-0.13256393455840778661,-17.124915402435757272,-6.9793753696334128733,1.8055506338523947818,0.71699205329212467586,-0.39686106528584635944,18.50240109169370939,3.0971670217390396829,-0.59320867408883692917,16.95114836437166872,7.2598564442596913437,-19.208584344697488433,36.857973685371803185,5.7198412889392802327,-0.61930515060159474494,-21.271191671996788841,-0.91892418139578335712,-1.6870830588515919324,11.302034311711100401,-97.53916448049787391,15.677013162358521825,-5.2134572489202382073,6.6604169783941973293,-8.5479854966996384746,12.473584895620314583,-21.500632298853826541,4.2494802360200889524,-17.673753541540786927,74.26867237969297264,-10.28275949581092874,-29.994069498497324844,-16.562676149124342828,-22.810682323727199616,-8.0168965394233779875,-59.690509763277326272,-34.197640447556615584,-37.678564844712852278,-90.183170613896592727,15.331181792774390971,-109.11600498117978475,-14.721131708802579041,2.8757247863981234559,-19.64776872006549624,12.423836116624682901,-28.243723766397234698,13.89798349100102115,8.4119249255482859695,47.101377243700191855,-20.2625781061340966,-0.21978085334347094437,2.7804958050549362092,-2.8867883678058339214,7.986870225709648885,-16.240403531332695763,1.8708689446353639063,-11.668079750412506002,0.48667403089699240448,10.254625400553583958,0.2400506133670565756,-36.140291937920331122,-89.932770363366500987,12.64390184845338716,-3.3433354144580591516,-26.298379866712444652,-70.438929760102837463,99.693546153059628523,-31.520406704109287688,-5.3495187188363555464,-2.6145322245418167739,-0.18204278479175736716,-3.1626688204966626472,1.5760117061135674454,-1.5026320122913552346,-9.3938740754270479982,0.63157320484629086987,-2.4785556413373277529,24.176659503006796115,-4.4983265051003744617,12.127896020419150602,-63.597200896887216004,-28.229193692478883548,-35.234347049223103454,-113.69735349263858382,3.5806893498417609045,8.912362775451740049,1.5016880061576971528,-1.9340596474850961783,5.0833310067896917417,-6.9952686384852365009,-15.589189007311734514,-1.1711611083994513116,-50.691993769147728699,-4.8065510100469497345,-25.287615343990143657,23.316464668171921204,-2.6088956283913602441,13.041101615754492116,41.728557110756092641,90.266578963239297195,94.493035331248250941,-191.05912521655361047,-28.238076284169057573,127.54673692012541153,-2.1771924781919054226,0.067726561580941146978,0.14338787220798443478,-1.339949216050258185,1.7163969686911912937,-2.6604507908781567238,8.1332666519249645631,4.924428410008625967,-6.5543165662320692633,-3.348678695354458501,-1.5680372794989216878,0.27307087376080829699,-1.3383775110607574188,-1.6316830295007656026,-1.1137232718215253069,-3.1728695971194045278,4.4088039309288369338,-0.49194132499217013699,-7.309504572505836073,-43.31342118992181156,-3.9101029285353905429,-41.935531636170310321,12.668771166114854765,11.314578743853489939,-26.646630741641800455,-19.436144754926317546,-36.04895816082451887,0.17075762835867189238,0.014027345096528512705,0.92026840024487210901,1.1629024371201595045,1.4537059957695026569,-0.33600277214988999441,13.404906309462404579,-1.556501509278013895,1.0079460234520201123,-1.5949357089908291485,-11.450522421659645289,-1.8261098750576072458,-60.774874307154910014,3.5961322639924921951,-44.549038349625298849,95.723761880580852335,-1.8415134910587422912,-55.003679961517839558,18.663397307125837443,31.24535662239003031,-74.377663591138812649,5.224894902417616116,-2.4909686293333694884,43.832853802707511193,12.402803960343991463,-0.080583794041493087001,-3.7744707899790359562,0.078510822640818267448,0.017599896031012505354,-0.42655199778095342911,-0.60171642832842986426,2.5608911774674925077,-0.95102968292959855212,-1.9698728179169531227,-1.535732350233014909,-2.613179188546156162,0.23548973072085691016,0.19388075590495346123,0.14491746671550229109,-1.2401949804008831624,1.10749843142199067,-0.39076456039187812408,-2.9546058416355829301,-1.1164266247292604639,-1.3996153086115672437,-0.0021811114934069432414,0.89001471636056028736,-0.49923401581239346125,-0.15043418392211763135,-0.59224986523620126722,1.4354796150072617333,-1.5173952036896125595,-0.51792999928986138691,-4.3506669188617292932,1.5489841199544107653,5.0780073751128966819,-1.5872474777123319889,0.75115843724637465506,-0.20050024121638218566,5.1492068471111629435,-37.76157113869709292,2.0918933715785645866,0.90277048068356768873,-7.2351321255080209838,-2.1274258477218332963,1.4545842409648657156,-14.119641303080230799,-9.5620849942754215789,-38.32161302522558799,44.185963714709288297,14.272752410898714714,-26.417920583525891232,-2.271445340655171119,5.6488521533890878601,1.0025482915596339861,-6.8334230337547658962,4.8338256451351915288,-3.2984129339671839354,-20.842669133544848847,14.930850795854235358,-5.7892375365939479082,-4.7203280842873436285,-9.4801736494313590953,-12.5383121134529123,-91.899681899191861589,119.49729723905733181,-8.8506169282838591528,17.417615709502236143,-9.270480473762559015,-80.150206669647431568,-2.5719540579845125983,-4.3822545378570838537,23.441163723925299678,22.448225342357130074,-45.10275635394135918,-34.394698210513851677,97.990939163145739599,22.508057477285255743,-15.765462977359492314,1.7966171747993613383,-0.53918908236103779696,12.588316036713390389,-2.5310434009716691328,8.1604819737426410597,-25.789368301320195087,117.29821756233035046,2.2913662361171791559,-0.62221732643226101978,-5.1845554095006445294,6.2578779560735222631,-14.037024227551505362,-15.221784276688309134,-12.15124779306130165,-23.13900137605473617,4.2401278882782253987,5.4630926287382406414,-12.731608082287982242,-4.7707826072334107437,1.6199816476366426521,-3.325710439626545778,-7.4045728952047635829,22.556680888497492532,-13.072652719424157297,140.00809231502253738,-14.845057180083005122,22.676762832061584163,-0.47514683781920086236,0.25841993000261515023,18.277720264118496374,4.3365484918040406725,-43.058181517998896481,-21.888717436559343099,-1.1961874190776082827,8.0423306880789873219,-42.933155452830639831,-0.14616201837677481046,-0.13430583680996491247,-0.58981810779848353743,-0.71234313233794721576,-0.94576172672030411892,0.40095990570557238364,-12.496784049940304229,1.7251821978929184898,-0.24967894825909500711,-0.24768523280850157642,0.15698129187492410042,0.51470036967696175534,-3.5907044804731915733,2.1884295523676278172,-1.6632000458679307986,-0.4796569588994863409,-0.1551399226053817304,-4.9294948989068645417,-2.7287453132180869986,-1.4544804591226099255,0.78968765102461080385,3.1593992730923847745,-10.27080607048321248,7.5282558208640262265,-18.919787185772346305,-1.1997044417960491813,-7.9324348973540814711,-0.020087316557315798571,-6.2878594589471665799,-0.15921673533184060867,0.10681151766899948941,-19.482753493295533076,0.69934990760267923271,49.178631799995962126,8.6011789732938730424,-24.467347038979184504,10.536820677021587755,-5.9592909099740429824,7.30325400524276791,1.6305850397821675113,5.6674242183504404125,-13.112738862153801023,10.989253391707725527,-9.6079139493042600151,5.3981239648009360366,-1.2545559504385883631,-3.9407187706378463687,1.7841191405416487736,-0.04438681516755454276,-0.97981273712928496078,-3.055180465761397457,23.726156440946237325,-1.7410736286568402331,-1.2352073951740332181,-0.257453927816034156,-0.12600631787855620658,-0.15152952823034240848,1.2682606267108031961,-0.90327763788350612373,0.40935227214098013349,2.9434569338747058609,1.2958013233750498294,1.3485015078932933719,-2.8665527530112719923,-1.3469220643383554847,19.330563091396506081,-2.8084686040403927798,-20.837720313089857171,-2.4974630678810574302,-36.584511795294567094,-3.8823807714410580871,-29.935667863248351495,0.10500910940206639732,-1.8106148357266489413,-0.40274154876443618578,1.7744865512378684702,-0.10964838999231654726,2.4627956007507569858,5.4312246325547528514,-1.4946522692455372905,7.6143918559162928617,-17.524868537409059144,11.473587900867251221,-11.036495448527585239,13.848070543445940572,-68.275216891499823646,-26.95760708264942096,109.01583773742814287,15.377994621498990213,-31.770041826665824658,19.813957303264988496,-9.3539902595288513254,-15.474285874612549563,128.6624990280520251,-23.000347605868732614,129.75052280517553527,-184.61765106751099097,33.880235359246285043,95.366806157373488873,0.078401684752462688643,0.67125884757461906638,-3.4743703111094768055,5.0123440342991605334,3.961959600100572132,1.7965254711798910314,-5.4130896718341316998,4.6148080101037374234,2.7399910773318492119,0.67343729995913803599,-5.8064196051826186817,-2.156750128397398214,8.9472790411652223241,-26.48537336098555528,0.15778432423606658652,26.979468755386175616,-1.4477456026390456145,21.398770566964834927,19.260810759927970537,-114.51009442605032973,151.49555349226625367,43.325807586911970759,-63.851746588941395544,-126.06888223803258597,-53.498381454766942511,34.911387025219156044,-84.961824825503029501,19.540824835262984749,127.21152586406716978,-48.698541836292228879,105.99899513680173868,-91.611070019413659793,109.50365795113788181,44.952205352582467413,-25.630905529833334811,142.13678596912572516,2.8687917746736992797,2.1017964103411048704,0.64796848979679955161,3.1316218297456179798,8.8276278554390223974,-3.3465549234700460168,49.548364566834813161,-1.4167441180605313544,8.2104268366796162582,3.793719655147063996,-7.403383512684560408,-0.50729720905347186477,-3.0100811191782965714,11.389088713257267571,-6.5393939743041897827,8.8224831378762136325,1.0427688002066073381,-13.409485951237973822,-0.62697453496196120515,2.9744746187688848593,2.6558382984735904309,6.7255629796099061224,-14.671284399044981939,0.32956892820937788713,-54.585823382721201824,8.388313461119468073,6.70872018318471941,15.966360617271179834,2.4409881451986668033,28.622718596349749021,13.210462588859694932,-19.192201244219699419,37.104751522946713749,-45.229959593844732524,-26.079161591334976578,34.723500085622788447,5.3534276287246793657,2.6119345039259984631,0.17796061719564765236,3.1590891186620031483,-1.5197378601592319569,1.4997186010928065247,9.4753137105400959683,-0.64083826946580935147,2.5090832835909147036,0.3209390106003625065,16.04671332887873092,0.9731338277845179574,53.331329418804251929,-2.8345584896813305065,48.805815360403215664,38.412861999628738374,-3.7889178898026494302,84.390424788465665529]).reshape(64,9)
        # Layer 2
        b2 = 0.30259117335102253543
        LW2_1 = np.array([-0.0010971721057184389853,0.0083962246462983558537,-0.0027307629311519908757,0.0047120975772234497542,0.0021490591706695900444,0.080023017553646214051,2.5403240847166892458,-0.00074869403897206054845,-0.0017733637883615511934,-0.1595408196098820619,2.5458116184369377066,-0.004811520537812731535,0.0010863185703986527521,-0.0072937864033696415272,0.0029400955774635255564,-0.0024996059667202401126,-0.0023702866186851839075,0.0014195436572453502648,-0.0030939630859683439103,-0.016508118056806648372,-0.0015877051983461973415,-3.2224771976829793552,0.0016592626149794943019,-0.0041771451524016114595,-0.00099316165197425670084,-0.010980007358198231454,-0.081321183662134241543,0.00092156500812220305471,0.13321547062925354066,0.018882273589591935803,0.00090447353143817594851,-0.082209264930844183628,-0.76256777106001749633,0.16070425316996186926,-0.044072375853990868044,0.0012062660007474501709,0.0071363243742063519823,0.0012545007649656428859,-0.0017921228123160056356,0.0040542203402466276199,-0.0023157050835605100074,-0.0043400258937529752334,0.0019445559102905661704,0.13490895461397242605,0.048727434125739772786,0.0061903952558800337536,0.0045627361625012663113,-0.0024619138003385233546,-0.058857286292253396809,-0.70263178253066527201,-0.0032593428520068593035,-0.021764108480870965334,-0.0019231326569150186158,-0.0014740033825958534248,0.020248678060316771532,-0.0038159206545389273875,0.00036217485798284687051,-0.0014429413334346081511,-0.0094053482098095074482,-0.18730162255769791657,-0.0047594464035936425231,0.0018832467739314864841,-3.2268167121976776279,-0.0022594723102877527394]).T
        # Output 1
        y1_step1_xoffset = 1506.14754098361
        y1_step1_gain = 0.00175936863902286
        y1_step1_ymin = -1

        # Neural network computation
        # MapMinmax Apply
        xp1 = self.mapminmax_apply(x1, x1_step1_xoffset, x1_step1_gain, x1_step1_ymin)
        # Layer 1
        a1 = self.tansig_apply(np.tile(b1, (samples,1)).T + np.dot(IW1_1, xp1))
        # Layer 2
        a2 = np.tile(b2, (samples,1)).T + np.dot(LW2_1, a1)
        # Output
        y1 = self.mapminmax_reverse(a2, y1_step1_xoffset, y1_step1_gain, y1_step1_ymin)

        # Adjust y1 based on SAL
        y1 = y1 * SAL / 35

        return y1.T
    
    def alkali_nngv2_bro19(self, LONGITUDE, LATITUDE, DPTH, THETA, SAL, NITRAT, PHSPHT, SILCAT, OXY):
        '''
        Example of use of the neural networks:
        AT_values=Neural_network_object(data_inputs), %This code line must be written in the command window.
        AT_values: row vector with computed values of AT by the neural network used. The size is equal to that of datainputs
        data_inputs: 2D matrix. Size must be 10 rows by n columns. Where n is the number of samples where AT will be computed. Each row is a variable and each column is a sample. The order of the variables has to be the following:

        1: latitude,
        2: clon, 
        3: slon, 
        4: depth, 
        5: potential temperature, 
        6: salinity, 
        7: phosphate, 
        8: nitrate, 
        9: silicate, 
        10: oxygen,

        The units must be: latitude and longitude in [-90º:90º] and [-180º:180º] format, depth in m, potential temperature in ºC, and nutrients and oxygen in umol/kg.'''
        
        LONGITUDE = self.to_numpy_array(LONGITUDE)
        LATITUDE = self.to_numpy_array(LATITUDE)
        DPTH = self.to_numpy_array(DPTH)
        THETA = self.to_numpy_array(THETA)
        SAL = self.to_numpy_array(SAL)
        NITRAT = self.to_numpy_array(NITRAT)
        PHSPHT = self.to_numpy_array(PHSPHT)
        SILCAT = self.to_numpy_array(SILCAT)
        OXY = self.to_numpy_array(OXY)

        cosLON = np.cos(np.deg2rad(LONGITUDE))
        sinLON = np.sin(np.deg2rad(LONGITUDE))

        DPTH = -1 * DPTH

        x1 = np.vstack((LATITUDE, cosLON, sinLON, DPTH, THETA, SAL, PHSPHT, NITRAT, SILCAT, OXY))
        samples=x1.shape[1]

        # Input 1
        x1_step1_xoffset = np.array([-75.95,-1,-1,0,-2.174,11.29,-0.03,-0.9,-0.1386,0.3])
        x1_step1_gain = np.array([0.0120518228382043,1,1.00000000007615,0.000296912114014252,0.0582326393943806,0.06821049759558,0.571249036017252,0.0424052243236367,0.00826143816767911,0.00416927246195539]).T
        x1_step1_ymin = -1
        # Layer 1
        b1 = np.array([1.1672697163170973056,-0.57699133175556205355,-3.339627622517827632,1.8643700783890064798,-0.76888937938239532155,-1.848134215104946465,1.5107330762869830565,-1.1708525904139213125,4.2717514124138524778,1.0604339464360654777,-0.43066944519607441855,3.2172217206224860142,-0.7283601957947674066,-0.3260567919727209163,1.3643980795985741761,1.4555536479518049742,1.1594162072369136318,3.8661125697839779924,-2.0289236730051998236,2.3335691883814084768,0.68280786414768079862,4.4978024871194453027,1.1121211420998640129,-4.4276583143490970684,-0.56305316879623867887,1.7963133559752617607,-1.8345310925294573412,-0.81043050674411032386,-0.19490167659854334969,-1.4981763441203135301,1.8993142206121584881,-0.23044422622461824268,3.0303880526612414492,-0.21865294565845871944,1.7872014242086029512,0.57301438582733466021,1.9167923788626788362,-0.10083534443780840795,0.62354895894007866808,1.4975249712315070738,0.39336210504703961188,-1.3280132269134143908,0.3515166197814393878,-1.0167299805516072375,-2.4460432683959321132,1.7525207081189424496,-0.80411038121666345013,2.1228077876822402104,-1.0928151753610138019,1.7132633094877838253,1.9760095216278683594,-4.8597265459625056394,1.037087428063784289,-0.028455748792265742053,0.15477250137368039895,-0.59515421888397779249,1.8749644892754455672,-2.1926521092009205738,1.3477918071707561953,0.71216834622748337313,-0.19175045649022476324,0.71338164821226546231,-0.27569773773688494023,-1.025883289492971473,-1.0524798142838229786,-0.13497147079627394572,-1.4547444628275991718,-0.0006769143719951159488,-0.20607776488902326828,1.5557086688135095542,-0.25530979134825493304,0.73194084167462980517,1.005218001195429478,-0.028852293640610000153,3.5892439889392466768,-1.6258748233045747789,-1.5286613152498917945,0.53800985535374856727,-1.5232438974038020607,-1.7635180651055806234,0.18230495718627104385,0.45733188348441278226,0.15946355169892462156,-0.59891954910461664419,-0.40384337296743622048,0.74903510740081624686,-1.0139401668960612568,-1.7043589022142102696,-0.18530292941450038358,0.54768706379044640453,0.20205737355209210659,-1.3314893011496959918,-1.0877473034678142305,-0.65394431575357336861,-1.3451262544941771093,2.5155972616522919161,4.7573336666020447083,1.9746800883322246367,-2.6436250331947337422,2.4701259241289492685,2.6900885085631434102,2.1504203160916772752,3.5778706675084408495,-1.3054333710178354089,3.5314152230560158507,-0.10644674629201268667,2.005665927641409052,-0.48177114195185433143,0.69912726269383151934,1.662014432771131478,-3.6633406023855994427,0.15039281119220801464,-1.1556768457657728977,0.32975423558136313096,4.3751388625601652649,-0.39413994485647307897,1.0706268616080851785,2.6741819077416715267,5.2019088894753364727,-3.1642382608820347478,4.304630522923378777,3.1374722913163632931,-3.3980019703747319504,-3.0036254504103800933,-1.4171961486591626578,1.1327685035848353845,-2.5659129202168542427,1.2673889428988722727]).T
        IW1_1 = np.array([-0.84909521123793341157,-0.82246813002760954525,0.072185755790166700185,-2.41145095168202106,-1.7521776209509940525,-2.2101573037122084209,-0.52084893147720245921,1.1364823422744012582,2.0510776277505535781,-3.0861099512826979385,1.902762818332933481,1.6195264493504695213,-0.19038024334434514029,0.42541655058280131163,2.850219121994149063,0.71857902004940910068,-0.10663316716843083964,1.3441957584598829278,0.89052401198906505631,-1.4743102052090313325,2.1843405010487266793,0.81270228459402704679,0.94783158797499666992,-1.9671965535866695607,0.21247995645959286137,0.25910368705593350702,0.63619015146997970334,1.1161962427293066202,1.1677450482458768821,-0.81699717617137135317,-2.1473491116620606611,-0.96968856310513107388,-0.63549367526637412507,0.15856913451396539849,-0.85234473700733937029,0.3610213522857016466,1.3918796192858200467,0.5756570164931555933,1.8180413787657463409,0.7081720939640804291,1.0627183677496194747,-1.9633019311037842591,0.82512418562156708557,-0.77468622602152337198,1.1171652074426012824,-2.2365783184573464482,-0.26731174367370835743,1.258841076115436497,-0.60495979895094276202,0.031172659867790629418,1.2219915369214642276,-0.50665828424483583259,-1.3181124879626462398,1.0106564933728718891,2.5620734052206732834,0.38848188088815188701,-0.24185225878085800377,-1.8139977030984661965,1.0727447537240191178,-0.20409036607731217972,-1.1707249214467727594,0.25026669717891475431,-0.024511938361889910876,-1.4895338895506085031,-1.2417483981534140902,-0.48328233529199843277,2.7524358164099083091,-0.66687535031169953292,-1.3841965016414812251,2.5724500778823538027,0.88130163861871968489,-2.4443962846815034951,0.20781077175744508412,0.12585820219525004071,1.3478800126244521174,1.7315911376791068843,-0.17018105220484713858,0.43264422355077164495,0.2772883504831497592,-0.033701816233024955993,-1.0217179218620862091,1.4184695210415447786,1.0822874966606432778,-1.0961300883667262074,0.90301884382045172206,-1.9358331733188691715,-0.0054653844688727706846,0.50911301382593210363,-2.634351016991271166,0.15498003806777432834,-0.80638605023936094085,1.2501953153303864141,-1.1497587537164919436,-0.79985040723176659139,-0.0058291975345579200019,1.4831668678193072886,-1.1628300943678078205,2.8293612176234104183,0.61432503627944756719,0.049826036790338791571,0.24473431674850040785,0.12198898598186173892,0.10809771717325025731,0.48802467210700534173,-2.126887520782807961,-2.1097782453381825896,0.13024310909083716692,-0.027972781042766518139,-0.035648832658415334496,0.22741981437429328872,-1.6757718637080709634,0.63925499646645655982,1.0060619079554495858,1.189861010031392885,0.052762256297588759624,-2.8860324254323326265,0.28846529978764429147,0.2610988886571901646,-1.0898641191170574949,-0.61870488595778494467,-0.46685609727085075615,-0.2469805968216234604,0.5737215329077414161,1.5780528609943214047,0.30508305276211644674,4.197771382551418462,1.0247542936535283253,0.39361838720946740189,-1.7756936951880464282,2.6975155979609612977,0.89804687960922857659,-0.77911032910274291563,-1.3247219813240465047,-0.59945960238195850067,0.031788563401640060335,-1.0381499637503082134,0.42385409068673640665,-0.9136433835725359387,1.0834073208545771383,0.44958105754771249263,-0.33337882131827301091,0.14502031822637251324,-0.51420601485893391303,-0.64279723036992442164,1.8531483193214826066,0.010777852133900979806,-1.2315815365441034057,1.2238148869943683561,-0.098416293914804317544,-0.15006361395396103364,0.18230135620575396715,0.66778829443480680617,-0.24842901177008025471,-0.32893858537230863393,-0.86305170611435144679,-1.8592950450985126221,2.1578905063770825734,-2.7292983051514352333,-0.68878787001952801461,1.1566209169599181994,-1.0738765824996610032,-1.3473730931700185209,0.32273881224884809482,-1.7160081065078389706,-0.031802968029362221891,-1.0920141457184280309,-2.8402317135045280772,-0.38819353587603744327,-0.78714127779570697285,-0.48212422620358735825,-2.0843036034952064917,-0.5366189318067776659,-1.0462465661411228801,-0.40321767480005632489,0.51117145286027354523,-1.1452638350017012581,-2.0821127105870664842,-1.4600079349190122624,-2.2186544881695784426,0.89476702348336722981,0.37712109154590001125,-0.88326256786283885436,-0.06986595926960426084,0.19728623394385602641,-1.211187472037124957,1.8405531800812695575,-0.20422948427519116432,-0.55252915452994966206,0.73829875445891623986,-0.92998936184821134887,0.51622533945359072582,1.8900540603040973942,-0.67199618820620199422,-1.5867579919004028977,-0.30112052900020669366,-1.4727902967435106962,-1.8578698790828811482,2.0829520176882247995,-0.32758882891400220583,-0.37315877951884185437,-1.6011494674682971162,-2.0454105944639993098,-0.68124122256328534242,-1.7449237853657464381,0.87528671056055251665,0.19200389383003535482,-0.010203027721664710559,1.5013643162338758952,1.8140760903187871378,1.8103026770370451715,-0.50421632731905119407,-0.209285170784525687,0.26428609345133846631,0.30533778171529468715,0.74345465128455401338,3.4468620101774543052,-0.75332928365360851686,1.2744013219586232122,2.0846644379769774247,-0.34154434317535847798,0.17686088649641151793,1.7508407556610909861,2.6936909085834677136,-1.1619106978904791827,0.81668815604666922248,0.21976131996045542016,-0.59808007596018253338,1.2751483985755382999,0.83262267333253492385,-0.7832018362152266544,0.93078561042758445332,0.119771160568741597,-0.4635937120924517596,0.27638820358200644201,-2.3399055570316393826,3.275405694579272442,0.9251609568839133102,-1.1879276321725780186,0.18016477092994598319,-0.79469464775927423084,-2.1323826188236005841,-2.0979459876457062784,1.9449552763661324128,-0.1656887639138146795,0.59191407438417165121,-1.1671220022430242036,0.76789232565618981141,0.42227553705004150508,-0.57400021694982339415,1.9211521420782136094,0.38301510898918400549,0.38712124285104199117,-0.10085554369651129891,0.11238835327144078291,-1.1397830528288892538,-0.75614600530116415911,0.30280346307033906283,0.59725333696358062774,0.093471180619360591524,-0.27177894070931862824,-0.62199336018030759732,-2.9185881347586537515,0.91551929189419267718,0.29530445027154478277,-0.15527508957053887118,0.81614660272515870965,-2.3944306957592749185,-0.37461969763985991655,3.5651024177197316867,-0.19293294955013132186,1.3617903322119366827,0.31662367760199899847,-1.8202944053830389937,0.91242537950583479933,-0.5840736016345438042,0.54714332007405108715,-0.60822734437774783611,-1.4066370109706014535,-1.1939678434268863327,-0.17393673252549440855,1.8801010350873734733,-0.79423413198352244002,0.090672600066727768175,1.0482637416730569146,-0.16366980298508493341,0.032201551471721434616,0.43555643988602066319,0.85190509469591824132,0.27235700860080586105,-0.16202042635367472356,0.68310270440666520653,-0.84526835596310323506,1.7725794981089173508,-0.89311668300824298417,0.84921051588974627577,0.49145674609456435622,-0.62603468236588710738,-1.3294744116739296569,0.84171901487632538874,-1.1460808920616682993,-0.88497595513682558721,-1.0006130956008165711,0.30072041254779380282,-2.1321626377455227264,-1.4300882958182596916,-0.16885447262826855375,-0.081971485890773868044,-1.8378953382206157929,-1.8495077219142335156,1.3736205366597380451,-0.44687187029658431703,0.7707801162414815721,0.22911717780837087544,-0.81245660167152122799,-0.93806483168983190168,0.36128524224335384352,-0.64439538714757516047,-0.5060222319365742516,-0.52142163896988669158,0.55801627984934232263,0.73508683029676802345,-0.37148424467923107928,0.97983386843389397303,-0.38496027163052531916,3.4826821098951565858,2.3750066576485089342,-0.53537048281962951179,0.57445763530438997968,-1.2832832918216625639,-1.3594641524570321156,-0.66422527624235849775,-1.2184946207458751122,0.61768199349130914477,0.18725946496054077239,-0.86630589776004029989,0.90408800167409142379,-2.9544813652855999031,0.55636454666060708441,1.2545645671828875578,2.2919934213984736182,-2.0776876218331898905,2.0151590940515529127,0.56777608657813083415,-1.067583887385072261,-1.7684781151633668372,0.16763207143528913168,-2.3253348517963643438,2.6565684828732090139,0.16695224525715113284,0.44882711184803908422,0.079348595234915469954,1.0663814648474558844,0.5896821258645033037,0.12376310949134722295,1.6424527770121128967,3.0961101725882156366,-0.30412555881040764794,-0.72897538080632962032,1.3581656517583313715,0.054212824435505124754,0.087960475265825371904,0.47235744222428843742,-2.245115766410930469,0.17782051062363268823,2.0758026415679631249,-1.6748539679169602845,1.0426239847181015818,0.65764955404365488256,0.19907907648300310344,0.39341186457676857735,-2.8980055906771484686,0.55327032460265956892,-1.269967249928575459,0.35590360667402481942,-1.2679431057155936546,-0.36821591834699313184,0.23997439396761127695,-1.2481378430720060368,1.1844071362395554026,-1.4746144041549902326,-1.5455707053428078268,0.66798197542572368413,-0.082310436157723460004,2.517256954923128287,-1.8375762410728275764,-0.45400632665805645827,0.61029949801086458283,-0.18963135272489384242,1.6599281414818485292,-0.17394230833300741712,-2.443900193558460554,-1.10348358256625656,-0.38518985301042246716,-0.1868064228069972188,-2.0410025531802333809,-1.1566240948626176355,0.56773781883746643473,0.56237833343870680114,1.0815296983052142821,0.35901980416296475074,-0.34348889761926804098,-1.2428312178367848517,-0.52766828428755685465,1.0415095440050343711,-0.01717071760342377823,2.6597930386559327509,0.2752826239114677942,0.39371002502968382997,1.7632954431662859474,1.7995106695962441723,0.059253525676394830368,-0.0043860868926615453542,-0.21699198570955735565,-0.22080325259220864864,0.51748608854030275772,-2.0034128084385898205,0.6313222589860891798,-0.92880561049692655917,-1.2746549575104180185,0.63657526373654560459,-2.8221146706723927444,-1.8894536541951256758,-1.9945049212180840925,0.22271349498057121941,-0.22744069609867581527,-0.64803374434069727084,-0.21478927098850703059,-0.40475810510842968881,1.6418054656773801714,-1.3799322842094772223,0.62044096788231795081,-1.0978166830373863316,-0.39056111868899601181,-0.75247039328135545411,-1.1652103249720640044,0.53998169159098829972,-0.75240495685738972842,0.85592567783134931858,-1.1673206166228689007,1.3959559094397804291,0.71321534492415172846,0.049658820504419970421,-0.39014766644791704087,0.15596629480108259447,-1.2419159345365184954,0.99893376319397098051,1.1633525384939955583,-0.84922982348188180701,0.25472190214715456635,-0.17008630134415506086,-4.561486954258668014,-0.36734049460590517677,-0.11130895277155949952,-1.1509431090382868934,0.34131421483315416143,-0.24213773124188212038,-2.0457542574011760017,0.25413085259988960063,-0.95104992055398240858,0.74169385838110790665,-0.43923778381981276597,-1.1997960788993993209,-1.8274287292810331707,-0.4669137094677435762,1.9259036135375460219,0.22380377240806423322,-0.29806681720202055086,1.80174370743712986,-0.047563238342893006394,-1.2075364706561251271,-0.054585774066776719671,-0.39455216254254898978,0.75621294827610385791,0.48670181431574183195,0.24183540828358623953,-3.4160071752133589484,-0.22527723193922422062,-0.017547772459470263595,0.42941259092685540866,0.24004800498928868802,-1.3576888574896048834,-1.9961769450208999288,-1.9487072852401525758,0.7581457722209106187,-1.0180131655729842688,-1.2481887419843336051,-1.0042962792764256186,1.1731613199201293973,0.65338851073273895853,0.33463027705152487146,-1.1309821105948245634,-1.6410665574082494711,-0.51727245502745011763,0.21491740479341567283,0.11958993301324523373,-0.55103378736702335328,0.28763492131284895681,1.6542881243932761048,-0.92216933584268157009,-0.48733106938429704424,-2.2923115054908014265,1.8717113235612099498,0.66573222698990386359,1.7865991159220537821,-0.069197693970177193146,-0.44287534258291216815,-1.0594043965465853585,2.1600786409824666023,-0.59257088517830380781,-1.7915841820004518858,-3.9359879845401217757,1.0145771397777052503,-0.34881857338704597149,1.153349576603643456,0.2983766582984591631,1.3253796171601126552,1.6747216526829546979,2.4538158852881273297,-0.24690572449887526751,-0.60439996315938071536,-0.029578916396713107045,-0.072809763910068700521,-0.27412973502497378631,0.1351155352729255521,-0.16388565353898212895,-3.1347809774573143216,0.069022584631771757846,0.14244828397808159681,0.38555948217104457632,-0.12519074801894669591,1.1695992446960303823,-0.39605282297268518121,-0.81571083867251559241,0.82921010761982494319,-0.67460450518560344246,-0.43666725887956331364,0.1498162058479652059,-0.10513277418349861736,-1.2019980097446394396,-0.76539467735331423448,-0.85976988191066117118,0.13003070273067135476,0.38466331367158529408,-0.55593728705423572922,1.7889955285606458091,3.1522123512855659833,-0.96494672180842555598,1.8414474247281975572,0.62382863207283767437,0.71616668659579374445,0.4061681512966522356,-2.078414258995922026,-1.9693443678705091493,-0.74558308724529509526,-2.1089756669087180718,0.45691133440894105,0.31049452329881904733,-0.48230631117506850281,1.2599273531454380226,-2.7610872756658753069,0.66156884179593544726,-0.034790018452869268806,-0.20777108949243994207,-0.51464559231428508301,-0.19745076847776951712,-3.6112648864825005468,0.29523450836526760055,-0.67582672883294059307,-0.19598539147740726141,0.40449238603172360529,-0.93764472947428278982,-0.6065246093696413654,-0.82567985627687157102,2.4425472628033846334,1.1891425372862092225,6.1215340462425968937,-0.16324029972136397393,-2.9720600075401515383,1.330711897386128939,0.33375131805694546738,-0.17290193446366119989,0.96201995359481085046,-0.058035868176232859039,0.5215599669538989458,-0.015790242417836934663,-3.9014231687754672429,-0.31250616675000347788,-0.19157702430282794182,0.010501835032071481918,0.99772527430202295751,-0.27474951318251439325,-1.4545637709906329427,-2.002281709824676792,1.284456575565407821,-0.31970620294939244843,0.25629997204214011175,0.72234940154210325325,-0.77849155085113974639,0.78816468656531102344,-0.79693447858702703979,1.0231969120232835557,1.1082522733635484791,0.49440664428691422083,0.82007090034204255247,0.14958306606832080798,-0.45870385050103268387,-2.46596016328847778,1.2025109289198092632,0.56282031252236930374,-2.2422886719341117434,1.5792177882458087179,0.44285141862964255699,-2.3557868347660417818,1.1928844737676425058,-1.2846875357361988712,-3.2121389314316757257,-1.366291370550594575,-1.8216951903318354677,-1.7245268757796041736,-1.1530740790817832764,-1.4894306692573562323,1.6874175611785113826,1.0227274290112566835,0.6187338986957329201,1.9775112591210080026,-0.85010511580396419529,-0.20255009527383727175,0.051690867904432738489,0.84826131137780147462,-1.7071073380347114856,-0.075559060380265885559,1.2269675783481710507,1.3068496758507766042,1.4785098308323110228,-1.0803989031639202878,0.63243478477584702535,0.9158393598270566649,-1.5154525189098955185,-1.7201125254995410785,-0.70271250716438982131,-0.85536587951825315823,0.095837860635593283276,0.22083200871422975498,0.57176030561189616908,0.37526520391159756684,2.4394714911801811397,-0.14270021551650516334,0.71276805610625093568,0.37018293795154211256,-0.47610885805914210378,-0.045912698974113541617,-0.021604944026653929989,0.028952559442711984367,-0.030688469601433312345,-0.12568581486727645191,0.69212055150152440586,0.095046611102377817626,0.082946952841223026143,-0.11851824674049345199,0.089802030510465161162,1.2446099382336701655,-0.83012263043277334518,0.86163604734022536391,1.3080152761047767473,-0.39383860820087163157,1.7453115127468616929,-0.74930425249933985121,0.86606310881794590362,-0.2101282200971751335,0.028954341689911324009,0.46970370734799404833,0.89229772490614733815,0.65350409698824496463,0.91427617573825570307,-1.4368049373240301403,-3.2509140567937051536,-1.0511626408968799407,0.46564108301753009966,-0.29590618539700919154,-0.14724818389941385366,0.78760345180651891717,-0.84468145961320906245,-0.068500983625568195867,0.62655372553967569882,0.87003243512559647055,-2.7093534358433930542,-1.7084990786648481809,1.5382815627094568178,-0.162679075464006756,-0.9655939041630823283,0.50286487665131140989,0.82851234779334415048,-1.5283680630028886327,1.8643703100977893072,-2.6894750495958263947,-4.1781808914558329349,1.2693322780448723641,-1.8864116846289897822,-0.05784394922816050999,-0.35132901768291230349,-0.9068437189523430586,0.16570710815086142631,-0.2336774420097129934,0.26740585105779757225,-1.4398800875345749706,-2.2583251614371429028,-0.73366711350603419639,0.27504995986596908475,-0.22168480943114363124,-0.47810192221828323733,-0.3650326487725910618,-0.0032627317761099684443,0.3658095683222946648,-0.13326903889725827401,0.94459509766772842276,1.3667167867943388337,-0.72548525690147713796,0.29341525871422491356,-0.12451474390653929913,0.079589465560891289875,3.6214718279481736829,-1.5412175013093174503,1.2300471395878360692,1.767958899213099011,-2.5120762860870762267,0.37488459641422450241,-0.47345210273163701453,-0.41002440409022439249,-0.2676078601521957312,0.55955209448809917205,-1.0517534674702053721,0.58781896716320969354,-0.33415460056591900218,0.58223937817564075381,0.87686778563746714532,0.29866050355898809965,0.81379790813416241768,0.2113658183122293921,0.28743587376974011338,-0.86461587382996929474,0.60047290113330265005,2.161228810056713634,-1.2492877003200573149,0.55940222172191145233,-1.2715487009495227699,-5.7969832269360903609,-1.4829927261193120991,-0.33845509332227408095,0.99624595894892920001,0.27354839018073245915,0.20428334653078117356,-0.97404944873980303655,-0.20324220031623232985,-1.0820056266883855134,-1.2362673650711277773,2.0358678343929295096,4.210846613306584274,-1.9525162483473639252,-1.6133063509202545394,0.6176643651963414916,-0.011767500458511047021,-0.77036688781640005885,-0.68027570173517681873,-1.0545258000230339768,-0.62890156616333925399,0.65152084902580431613,-0.95637374795101881553,1.4517767398425767134,0.47162419402423216841,-0.85869973871661564591,0.25602096465343798792,0.46258259006198665375,-0.71545319147482555611,-0.61952152957362927044,0.17389871024477926431,-0.749120163023899166,-0.59466385216958794757,0.59353280254865148358,-0.38344032533738375834,-0.558578723204491423,-0.13749268986263926684,-0.7907788224405647437,0.12079248990085561521,0.76502996976798087747,-0.62778391646572262452,0.84608958385761390275,-1.632956904201125381,1.3195053156087581669,0.55890347106928972565,-2.149706290792927188,-0.42933206553423419738,0.34709438828474586947,0.23482248030240090997,0.037821701173306722377,-0.15292753379895909771,3.6880442259501982072,1.192839264951476963,-1.0825334680662048736,0.19165326648696442979,0.7027538328593178063,2.4396713300502210764,-3.0983530389091571422,1.5654692952739299727,-0.76219492228757534935,-0.49296759816572510715,-0.4096964280951571058,-2.3537106116350909879,-1.163419519261796875,1.9815909398304696332,0.1639285219858574727,2.852800495993526475,-0.0027090601931140179462,0.79168503098535969453,-1.9706590681622482286,-2.1177741772595091163,-0.94176068097768039777,0.46260643146754493182,-2.0708937355580170347,0.60108985404113313145,-3.2239138642562865655,0.65709291958464433048,-0.50753249197640570856,-0.94549197060767153911,-2.4392880877738600809,0.69395809674849540105,0.34119350019341188052,2.1204899112603516897,-2.6372548846739154449,-0.54140548197911053663,1.3646574607374539756,-1.2745975599802374933,0.16929361485627358874,1.77936967645515276,-0.8847166007871136717,-0.45794094959688602664,-1.2588785243824018867,-0.62565844064779108091,1.0906396019000195174,0.19764161655419418273,0.085880049902789495908,0.028520734168197860864,-0.75381357957307693063,-0.9908263417519470595,-1.8479055647359428072,-0.21016027613372662008,1.3409944150322981038,-0.33150654305190574433,-1.3083270273552998209,2.4458716538737745871,2.5800110136367804259,0.84796432120492182261,-0.1372983535781778508,0.23845070051073766204,-0.28791138308216374098,1.4586067282483119456,1.3696516875391757662,0.67870534141143301632,-0.2665155956558905026,0.30357646889116851607,0.42603387490640087787,0.67183342633147169476,-0.066983347240707591386,0.062733268348084111898,0.231648629237925896,-2.794562829696488393,-1.1157097409223977191,-1.0201934747602858788,-0.069956645434457787047,0.05511596039721373963,-2.458174111218891067,-1.2652093952404892541,0.71674717687566924518,0.14121555928559947901,0.42632776058584237466,-0.1358721975858442621,1.1912245073041416443,-1.1018288995506262395,-1.1685553168821931624,0.41900789815332661892,-2.7518316281495724951,-1.6228705249929877841,-0.75524184513526060325,-0.10074060655021697952,-0.019323025083182517048,0.91645527016740568893,-1.5989463875769831525,-2.4481078984290323142,-0.22417586495521729661,0.61154228103994467958,3.6918797265385068229,-0.65038833545346286247,-0.00098772645780936417156,-0.058229134179075527078,-0.26178271021872651092,2.7400352655272812719,2.2005660427477757857,0.70952780564290440779,0.3325260984849979784,0.20047233607183187476,2.45576852258760292,0.77251708212321146263,0.1033546060363653013,0.21240970349478066614,-0.55548300990337384775,0.22119800738953346309,1.9497709870722470527,1.6140405265073989316,-1.9425877569251295274,-0.0029475288867727390471,0.28762951485130516804,-0.8144239472450871542,0.91911398730600080142,1.0970757552005361291,-0.50285337381569694681,-0.38928026506092666681,0.45558081225270458114,0.17426543907843602965,0.32218045043911297531,0.39000215138918370439,3.1997377527281534171,1.0670537707338221267,1.2746672034106563132,-0.083548255141461677531,1.5567688453209191923,-2.5998341524899455379,3.3880853697820096926,-2.0737735411649249606,0.83140592483547004488,-1.2374537467087554088,1.6879946559435652365,0.25122178014580315297,0.1108303661326333206,1.3368973922969722423,0.044684829818178235794,1.0485816218682766365,-1.7757503851645357607,-0.98880721242789570979,-4.1406499831764582709,0.071634915504104570982,-2.40781606591694608,-0.86424174363426353729,2.3295019499645284178,1.1676093123367992099,0.44441073255103308304,1.1242712067991451619,-2.7455532825891397763,1.5158437612650070836,0.34379562369196331462,-0.48165280979731345257,-1.924359266156891568,0.4067896432041805399,-0.17469645736168937233,0.70243518974959495704,-0.31088285121613989936,1.5778560439797482129,-2.1375771054871521848,-0.29155609620536487858,0.042132430529889297599,0.38838242942563283577,0.068009938702856723158,-1.0723038336035981555,-0.39502975692291847354,-1.2549603885913591661,-1.6724849974181144052,1.6097765614787313826,-8.1256131659706394288,0.81588901901031429809,0.084777315713292847321,1.9414904494194942242,-1.8189273065260678219,0.41268655835792267261,-0.28570865844403875444,0.47506143404959449983,-0.27318584515496496801,-0.088773164774521018394,-2.7802420193165162665,-0.42120390025950182888,-0.13619982203963537648,-0.092259594063337516112,0.20366697705522160411,-0.40475202635554735631,-0.51346458762836699741,-0.36805795304768063048,-0.26668892882365724528,-0.22271513795188821461,0.33632323766643518193,1.066675995653451281,-2.4441256599446701259,-1.6628200567083717409,-0.34024765309065041485,1.1306339154068296704,0.41350924788515608377,-1.720981660136484237,0.76444569269073459061,1.5506772893522327017,-3.9681292943091541758,-3.6628677013942789742,2.6410508175141775844,1.6167566730525526619,-2.5711685006006748111,1.2146126499885359085,-0.78583297591424994266,1.2350885361222319059,1.5703020231886506419,0.41107652199716038233,-3.3129968754913430296,-0.42217911716024175695,-0.40663752835689304099,0.45642380619770972494,-0.0020527583771941162322,1.5033312278360448921,0.43197977841734913618,3.7787724447367234681,0.11436137003416221858,-0.41202915521545152577,-0.54172415562270348488,-0.58876399714049909573,0.40664048953255904628,-0.3524141106419295677,-0.040282217947809777214,0.46566360872636480828,0.95016380888532836479,-0.28589235245338934233,-0.10668927317159115908,-0.4309103494037249682,-2.5982301819116031538,0.3610068764873421987,0.12110740759018105706,0.806733519209540062,0.076502512456646187822,0.79997267293771701091,-0.26712829990571335115,-1.0949184058852288182,-0.59858294841896231286,-1.875089680736594655,0.28075977077702474194,-0.81964442254808900223,3.111172035601889263,2.2779099006511542846,-0.88202297060633350068,0.95779624642110017252,-2.0667608556968608546,0.27022702072648852045,-1.0803514574459354147,2.1106930193721660238,1.0748043243435179139,-1.4312768223838623349,0.53398821209893398976,0.33141111442311366186,-0.27186703407636858554,0.089224143168493405542,-0.062354554268222769919,-0.2556517166533741614,-0.1984229865080053834,-0.57744514213646924716,-0.065000548153550566366,-0.06076375563170145766,0.5136347397664425829,-0.2451510123761001525,0.0051860443174523672416,1.3982767578145149923,-1.0133564444656133485,-1.4720417534029053286,1.766772257831718429,0.33276968577937260374,1.4825166687559594436,-1.0150091872804953841,1.9101201554541689109,1.43503571983961975,-1.0402294300116161629,0.036775353742377239752,0.13304024943434555883,0.018071099254674850842,0.56892246265463952692,-2.0009068655389903313,-1.5129162648093628096,0.14537808202181229378,0.0071873274090768195926,0.024088257562220175001,0.4724904033615171528,-1.510113264025239932,1.3903409949005474111,0.84958514778194516026,1.0331500888179845354,-1.7526520351228107586,0.8774686215819934576,-0.97664858446909430523,-1.9246188308017750934,0.042869154452740622363,1.6137281852244460545,0.45426581857848219448,0.12189786909866431874,-0.19688104787008731122,-0.69162383137184424431,-1.3487639205240913309,0.81524337429110782516,0.0091858413640333643618,1.2900921365227253634,0.21885372925322787996,-0.088176602009556001582,2.1581603422412087845,0.78368028732668515435,-1.0372054833826773734,1.2130118701435257389,-1.6979248382354026337,-6.1667021055084747516,4.7065124443432884149,-1.1109824400243775155,-0.56370260735508315175,-0.056332826920715874108,-1.2927186993276269522,0.0061235254379707424605,0.018421313824553031679,0.038851332692666253055,-2.6566167908900397698,-1.286591336626229376,-3.1157802672484238293,1.7062862431929994855,0.93946251049936424504,0.31927501701947996748,-1.6658205527938498847,-0.25705459053950752146,0.63457244091523401508,-0.43037701369382802552,-1.7203217460323891874,-1.8513272341898634465,-1.1240936728295984892,-0.19813051494018407706,-0.43111109858503382508,0.67858894680543313527,3.8442754268490002545,2.2166782639956705836,0.68415396202122769065,0.22165071953165757512,-1.6539060428031435723,-1.9712431340464897644,-0.25187068672149959259,0.79683666891375526387,0.051355926479240331106,-0.71315304249065314401,0.48623144839848431165,-0.48864649632632228826,-0.5915970358679883967,-0.13112456367304206606,-0.066474236013933873934,-5.2661537524913812902,-0.70427314852910294363,0.72984178622706186168,-0.13792839552449090434,-0.53641443986395553889,-1.5650764908418306476,1.4888459339217516852,0.12923431294737675046,-0.064665660289827509022,-0.45091306264146580052,-0.54340492141753471422,-0.87570919527500190593,-0.34491685786764353372,0.651569846075600978,1.8984630772232227169,-1.0461953817530964539,0.090820144174078978883,0.78024089621929659799,-1.9081387594079470826,1.9049976351553081777,-2.2843964750350096438,-3.8576340079896729307,2.2677275943665442526,-0.51394742605263987745,0.22531720381334260916,2.1868035441053210732,-0.48286325534786334046,-0.31397626668389255755,-1.3692985270808883946,1.991698829469570331,-0.89990903038715763795,-0.095828733661417239698,1.1741257758123602173,-2.1080888607934005208,-2.3402186627302681288,0.69681023498801852867,-2.173485735258587237,-2.4816386793003215594,-0.8571697324741033297,-3.4605228107093655154,-2.0604075925365390454,-2.0509737375859509179,0.15125830633534531611,0.58530133927392047344,1.4243593283943762895,0.64666026362522455173,2.0810820466149393404,-0.014551043933144928999,-1.9389908554127943674,-0.54794333151419916117,-2.4958083786949449845,1.1014011903114715452,-2.5916052366360640136,-1.9192290470470876329,-1.2721311542826623242,-0.83646490511687898728,-0.11797526630023034977,0.37494494718712384485,-0.64664464730017290339,0.078966872855067760106,-4.2418532478457118273,-1.9835746251685404395,0.84166945431861062143,-0.85444281099959862313,0.067280452863280493236,-0.91563802907388924801,-0.46962750624732502169,2.5179695112484892228,1.9546419139151651745,-0.78342155812223590594,0.98548929825766540258,-0.71243010386148730717,1.896572473178771423,-2.0564932255019550134,0.0031334943582792310589,-0.78575538472492689746,1.2936241165020907484,0.31152998941941378863,0.74771888412598686013,-0.23454769682847945167,1.0879191776652268331,-1.3525360456435266965,-0.51657898580344141504,-0.43144406423768699721,-1.2924011924358882464,-0.76057940593672312968,-2.4970327430032495108,3.1958308677575240075,-1.6376105102597136032,2.1838402834292587329,0.043927051615649505278,2.7394467089763625545,0.12531824209512851254,-0.45059644560140582614,1.6059986888442800979,-0.91882495784442397291,-0.34587111348915533515,0.14023846240893264592,-0.046105280450480512489,-0.35747908386502547096,-1.5002467572571309695,0.72227811911010231238,-0.6863739371992897409,-0.51140368972923933022,1.6274371582099413924,-0.17089234181579862626,-0.03749974453417827952,0.35385755145306690972,0.57875063273498683625,-0.46129018616753747484,3.1775194585771098232,-0.80880000739954172051,1.1441101794506700617,1.1479653878048172722,-0.71762282074954986122,0.81105228543931973118,-0.33062942492834102026,-1.6943981409233066504,1.2086075786936243404,-1.0204289466012159693,3.4593759786286955027,-1.167299379175615659,-0.81538999085673269374,-0.70771064177796283445,0.60288056396754630128,4.8106705245266443427,0.81002263913126271166,-1.4590603689903229867,-2.239889625849031507,-2.8726154721054948382,0.84410476607153817064,-2.3224815470845698862,0.14861403418399032894,1.3716149301984912334,2.0916615813484367159]).reshape(128,10)
        # Layer 2
        b2 = -0.83820453178858156384
        LW2_1 = np.array([-0.0091621928461664906007,0.020499175347955898158,0.0096616313904745697305,0.024580892091189368576,0.022857115239071194163,-0.013468729293060061059,-0.079720816303267480474,-0.032228027956228193218,0.016400477317010039857,-0.036849745109865959802,-0.60594784096158760267,-0.040785858986042415608,0.019910577195972618825,-0.060076182691277318915,-0.15896996316153960693,-0.057629263828014899718,-0.011262588264553967735,-0.002791472742858066864,0.10867157705378170662,-0.0065339922423142682284,0.014629445189452094239,1.2816585198443706251,-0.0040948956879632431027,0.29828436365313265588,-0.0075562643449888526256,0.12043737606262050477,0.010157965662893841952,-0.04991288576453214304,-0.039617257350177223496,-0.014782437252088833149,0.035641574162093514477,-0.11484288921826206475,-0.054326435411080960247,0.012334321589722143167,-0.017853386848455742031,-0.018690859666462396327,0.014648773013650754488,0.012783677933005365909,-0.0080563025384927482164,-0.023481260161486244842,0.023272341510389420172,0.86897420067759478801,0.0068857727622334856041,0.044842473698938789539,-1.267210313249124809,0.01033490887603655782,0.014835707960181406667,0.18629648459971023811,0.0065889182536180024991,0.026308588100060668891,0.0072372837185643631303,-0.0060397543315143346898,-1.2462375342323432914,-0.048619160119071518078,0.10754402083366017273,-0.0054228145434581237483,-0.68903015352513985459,-0.0059032744637894894735,-0.091513165791911169067,-0.012025985223733728913,-0.032920725593600465297,0.028202410973204992961,0.013001527780293394704,0.03407332559405622241,-0.45255814674663635833,-2.9881684393172212033,0.067222884540477242932,0.11017835556751237602,-0.25582008575379439064,-0.019281188729591117875,1.4901364364538045582,-1.5460462574784392675,0.0097478841570756112611,0.078919559994706969808,-0.015193098387734416121,0.019483331601285031748,0.049843726322310273613,0.23327885666762282479,-0.092993509459095152758,0.33039194859745185662,0.0026166532200554070905,0.0046323092555000831491,0.011408249354225659736,-0.015307709556645093807,0.0095261377278500706384,1.7606193719511167295,-0.27378773712848974986,0.025193221597254990274,-0.0022323382722107556163,-0.30008399373934940835,-0.22613011337331861972,-0.0140916093778856652,-0.015301663695830667461,0.003899994273248230843,-0.016238658132168695691,-0.19780846499367146785,-0.01184265481049678187,0.31240155212553438746,-0.043109691587390246148,0.01638037900483213169,-0.036778893719220509539,-0.013918344397690142131,-0.11099920489005339619,0.0033365065712779224706,-0.046439993983029136115,0.69428012030428887247,0.0057891249603868868631,0.40607440718063175789,-0.0099306887629880512269,0.2448928709143096405,-0.95676058943425790204,0.028602841363114746981,-0.028361562717391514132,0.0063768676471979693007,-0.30451192756431183506,-0.017929642383658832977,0.017321225215849417323,0.014939073792498614238,0.030106386733400734845,-0.011926262477143225946,-0.27810398866601121481,-0.084025343574656616297,0.041239049652881776264,0.0065861475740826265837,0.065657334221065899449,0.65603322048251788701,0.011633519710607082009,-0.0052930409717117524529]).T
        # Output 1
        y1_step1_ymin = -1
        y1_step1_gain = 0.00124015625968872
        y1_step1_xoffset = 1025.5

        # Neural network computation
        # MapMinmax Apply
        xp1 = self.mapminmax_apply(x1, x1_step1_xoffset, x1_step1_gain, x1_step1_ymin)
        # Layer 1
        a1 = self.tansig_apply(np.tile(b1, (samples,1)).T + np.dot(IW1_1, xp1))
        # Layer 2
        a2 = np.tile(b2, (samples,1)).T + np.dot(LW2_1, a1)
        # Output
        y1 = self.mapminmax_reverse(a2, y1_step1_xoffset, y1_step1_gain, y1_step1_ymin)

        return y1.T        