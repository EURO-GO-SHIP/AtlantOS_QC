function [y1] = alk_nn_bro18(x1)
%NN_BRO18 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 17-Sep-2018 11:00:10.
% 
% [y1] = NN_BRO18(x1) takes these arguments:
%   x = 10xQ matrix, input #1
% and returns:
%   y = 1xQ matrix, output #1
% where Q is the number of samples.
%{
-NN.mat & NNw3RMSE

These two files are the neural network objects for each of the networks used in the study. To use any of them you need MATLAB software with the Neural Network Toolbox.

Example of use of the neural networks:

AT_values=Neural_network_object(data_inputs); %This code line must be written in the command window.

AT_values: row vector with computed values of AT by the neural network used. The size is equal to that of datainputs

Neural_network_object: NN or NNw3RMSE

data_inputs: 2D matrix. Size must be 10 rows by n columns. Where n is the number of samples where AT will be computed. Each row is a variable and each column is a sample. The order of the variables has to be the following: 1º) latitude; 2º) clon; 3º) slon; 4º) depth; 5º) potential temperature; 6º) salinity; 7º) phosphate; 8º) nitrate; 9º) silicate; 10º) oxygen. The units must be: latitude and longitude in [-90º:90º] and [-180º:180º] format; depth in m; potential temperature in ºC; and nutrients and oxygen in umol/kg.

%}
%SAL=6;

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-77.9606;-1;-1;0;-2.19;3.46745;0;0;0;0];
x1_step1.gain = [0.0119075545098077;1;1.00000000007615;0.0002966038855109;0.058208064727368;0.0538422502830083;0.576186223387399;0.0432304376865664;0.00826630735784018;0.00280544255856361];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.7357240687465078643;0.26364872450015031102;-5.0459174735623522068;-5.5601558433513051938;-0.45608792860067592922;-0.074154741218188963137;0.69234572460633780899;-4.0256392606238327048;-1.4087401081225614519;1.4929840197931150136;1.7743362155269744029;3.9961302760722747784;-5.502282669807618376;-1.8643887884364673813;-3.9017054428146105138;-9.5379111846658730656;-2.6680570206744271822;5.0752659630237504373;-2.0474181852790644953;-4.7456538366873921575;-0.96544934030434736982;2.6482423411430535687;-1.0531307825115325816;2.5631337901612121222;2.5587185704966870503;4.9372324791346837713;1.2420487795444528079;-4.4183673486478705072;5.2958990293229257773;0.87653255177757427585;-0.3809172829429283702;-1.2890853600001663803;0.94577163404579478456;3.6217917842684483887;-3.7502634359194804148;6.9659858642132910234;-9.0767573443795424026;-0.23659838424950171976;3.7409595600504577106;3.9785863260256570939;0.505247348922874151;-3.0658441130191143031;-0.58308472166213864973;-0.24333997073741645001;2.5219369724674818301;4.1797062987165434222;1.2892747748356463422;2.6222283286953715908;1.4213872897866772771;-0.66974374261578084599;1.7464732691138913356;6.3957887593824329642;-0.63000390326131439078;-1.2792688784242502997;4.1156351757141340642;0.75473113146211312507;8.397296374515677897;-0.54942381664674400099;-0.91800568053335585006;0.55941744393440073768;1.4002771158129283524;-0.87986065339789809592;-5.7637374870028654783;3.0434620690021896294;-0.94899336178734006175;0.19734408636450348484;4.2117837474206165638;-1.1091722677321935731;-1.0975861947279006436;-3.0085368056291521555;-0.57524084493247140681;-3.5143080350385806909;-2.1783653858911162793;-3.9459130153396348994;1.3140052154130512641;-1.7837383890644404882;5.5186315935018601664;-6.3475306220176586081;-4.3110572299532687879;5.92105045670674901;2.0422736621583750249;-0.49076888465977192011;-5.0490181799459952217;-4.74094639972794063;-8.6491994553512174804;4.1369997445114679024;-2.2453340004533806074;1.0444110093292930941;-8.2005351786219957688;0.63672931473450233852;-5.2927017863717171764;1.336606466568137197;3.1408837797047790552;-1.4044977628731700747;-4.5523818637006492338;1.5319373245703349351;-1.963953489180231049;2.2210064350141074385;-5.4657691960607523995;0.30288350645674000372;-0.67703679845789577207;-2.3286554344939336403;-1.5314839548814216386;-0.41555249878148708964;3.5404252727768574793;-4.582264630019012408;3.1006693681640453697;4.891355363091520303;1.7281548902113403887;1.915559577166662919;-7.4305425102893014611;-1.6502449191043533361;-4.4400132969825776286;-1.0412734113205019959;3.9434120246033432799;-0.28243550731390038022;-2.148131381204191559;2.8259417543695648511;-3.0874852939576991062;-10.615663040743351431;-1.1329705625446280237;-1.0957029483134705927;-4.5082612202443286264;13.110676396640103647;-1.6498753801925853946;3.8862675099790209288;0.97974471201968293954;6.6931914798543488132];
IW1_1 = [0.35363563020524391156 3.9273312049620194841 -1.1525948672489536584 -0.049331799380895158258 -0.14389713172486129356 7.0825730950463228197 -3.3805563727627925275 1.3705358257455475535 -1.6646397879441006129 -0.43280558148091741177;8.5870170274292192403 -4.508908789840091913 -2.465101906870207582 -1.123076265472574109 0.12374962090144620008 -7.4780849949640018082 0.36389119057421953629 0.98596500574223033819 1.355790468304902241 2.0147010305094785743;-0.19201040628322613157 -0.12062756623901092767 0.83399012441542963447 2.0177346495652184188 -0.20432090396990384984 1.5760892903156575873 -1.4566688527458577784 -0.056082596157148653648 -1.3919296305063526553 -6.2504109352395182952;0.59638776765606660302 0.351036231427468981 -0.20937480336232044964 -1.2903703437357929573 -3.7787727983198817761 -2.2136605093185979243 -6.1618200406572913863 3.0354006180568005036 -1.4697506293299624769 2.1031396588393667102;-1.132391710136212426 0.13962125864444432932 -0.11145927161103924563 1.7270231431806846167 1.3220614683807967449 -2.1054637890102205766 -1.1084793282826537197 2.4802096354721343552 -4.5802286083893068991 -5.2742910271328504734;-3.0477228314320394809 4.4384812357065950295 -0.1018323477129594451 3.7565820005021928196 1.3791871798126000837 3.6957262283971332728 1.6547943521884271867 2.0496402067020262905 0.085388412596053717141 -1.8582009482313033288;6.2266925552041829661 0.86246491957354320945 -1.9806975064082805726 0.85306281410317152947 1.7799060820722480969 3.37823459560498085 0.81413369436937432777 -6.2103450553886814234 -1.4422531688710134024 3.7867342864516175815;-1.5109789024353437181 0.03901438543277508525 -2.5367581934620284656 -0.11286140034468281068 0.15151928677199261175 5.6790478021513965956 1.4186981080129217325 3.0861637799490333478 -2.4979776437771752384 2.5742112964427077415;-1.0650270298729747065 0.075926454138298349328 -1.4285638163282468049 0.27267405206263845008 1.5105310365233055592 4.6989429016985333476 1.815644438619905543 -1.0586868023163544805 0.47499423752933161991 1.5341438639398656818;-7.405145889958923533 1.7993380481880105748 1.4405498789122064274 1.3409501743697405107 -1.5635871860779479992 14.795850358290142168 3.6902843120980102221 3.135098908409300833 1.4540464370542016681 3.7911392163205541728;-0.61715765117513332605 -0.56235072403572883282 2.6337349999202612771 1.7827190948677735793 0.76803643121305698038 5.5793913566735602316 5.5982021148274307976 -3.6161160954249198518 3.2771299666109898752 2.1059873114917855297;1.9695678125945899062 -0.19371750868895951103 0.82107400478340797356 1.0370045594660883825 1.0127568166626210733 -6.3341214270879389048 -2.7667697476843855497 1.3136319826505482578 0.64806492130877157987 -2.0146844771192120582;3.6550398741928651347 0.42526967632122708585 2.489933588040065704 0.77020094223585366944 -1.4476691177786922271 5.5411367877185853104 3.0020615541694124495 -3.5635838401132389208 0.0043055493497343687304 -1.9264233108944157635;-0.18745112194185595267 1.4124539353616116788 -1.2819985513531164667 0.64638447292738754335 -0.82093788078160934152 1.5252483243896310938 3.1659818503127690192 -2.8033911422920527734 -0.8911358206275870053 -1.3807920266854756264;2.0186276209922855429 1.0566100939262683678 -0.11503817581664511904 0.44025024467967766029 -1.6009434373282087627 5.3046053594226663108 -2.3335634662258843974 -1.2928730803030374918 -2.1777016195044183178 1.5468796039564747247;0.15941543805612032325 0.084560165159496006315 0.33793889840129454072 -0.42918338039091918912 0.25169372467050593611 9.9293872303106613941 1.1318041467647386167 -0.35311806269946438563 -1.8290279927022918827 0.52285062518226566031;0.038377050437852298914 -0.30579059330986396725 -0.16126292107857076452 0.070637954944594155693 -0.72824549612139322097 -1.100727488651334518 -1.7496349044303396436 0.26414961247997653659 0.22304186366460218571 -0.26147882401801691987;0.61501666718641723186 -0.9399920214181055611 -1.2802706590486967464 -1.1881939813259463357 0.77873261975652929845 -3.8092893698739449526 -2.5415377732965893642 -1.3952843158065226792 -0.16973907963367868001 0.72124157494199414575;1.0062821344567416393 0.40146326014913813474 1.7864622088377735132 -0.092795167989429577782 1.9792888901561302983 5.9866550160030662653 -0.2315283344259714271 0.27567917123381313615 -0.36687771554580544953 1.5616211250354603557;0.34738274994422491115 -0.009837014369377406961 0.51191064342437220258 -0.16755924338111014005 -2.7527075984904496586 5.1655621521613639402 -0.10905231084461478042 -0.5554114901540949667 0.43426931841060767425 -1.4286142453405299424;-2.6698097221908025922 -6.2790159232012676682 1.4594940292763858292 -2.1593189973460988895 -0.58012217715339720048 -4.6651531421753951179 -2.863421776752057113 2.1685572147498479723 0.57013498794657346824 3.1611373576380548123;-1.7031276193983149181 -0.48809121805598243427 -0.59271182954644074936 0.05729323124689569835 -0.28326483796397783355 -0.13444129351504741088 2.53905736597712961 -1.2937066594421788857 0.79713191478429046288 1.0789570591770252239;0.78139115648412693638 -0.12621824411079871076 0.1048552200559743075 0.075909797332255071756 0.96908389891562896068 3.9958711250438083695 2.5359861454600802766 -0.42798954591423954419 -1.197837189988948392 0.96438385441994978198;1.9097828457525316548 1.8419415138145720512 1.7004040207307089538 -1.9852010743721311137 -2.7991380500461469083 -9.8372179188195474353 2.2984314159994805316 -2.8308714284378706516 0.43154405438016119056 3.0409077410503995154;-0.56885495983520051322 7.7316500705425657003 0.50513051343869430632 -0.95337884073691714359 -1.7064672162193021965 1.4111420311069922118 -2.3315677109897006147 0.73241188995928330208 4.8744967508279390955 -1.0920018590941622527;1.2040713585384030804 1.5152706155328754534 -2.9443599725281002222 0.15902383938792974405 -0.55964331295378721975 -4.3450209568304520857 -3.2185453945799662456 0.47891946019454190164 0.74284900105109985535 -0.72643036727875742731;0.55652112142278786777 2.7636467710383678664 1.0498713764001637028 2.0175235703410612231 2.4572534893592949956 2.1513885764628750685 3.0575504682690151093 -3.921983194237026904 -0.13274339975675578107 0.063058307164587643068;-0.72978130191726942044 0.57572484269097712328 -2.6601677288724698833 -0.16034434424472696068 1.5945871983835939734 11.268491945982033187 1.6355108682274717147 0.62037158880321230381 -0.98446151758491162731 1.1235138357461962322;2.0728467578458937837 -0.3055704111968589598 -0.1767356766365564269 0.60505266167364502028 0.18466644285549366211 -13.023062214911117707 -2.8090745794201890106 1.9779487065849221672 -0.56814603045934086722 -3.4697767104431203045;0.62259576341332734106 -2.982109925369413439 -2.9057492002628970695 0.24395434397198928478 1.4280541319305075643 1.6421983050342143784 -0.78772462485197880522 -2.72537123190561692 -4.52262718809473796 2.5866626298094996805;1.0344395796361083306 0.73830523894765065496 0.68754077583542327901 -0.65058004579553807556 -2.1640317173563867748 -7.04023923377316585 -3.6718752186041889729 0.6217641818777217555 -2.0527079364511919835 -4.2228922117836980021;-2.2256488382101018431 2.224157564309838353 -0.21693552557032036443 -1.7732286624230821914 1.2199824479789020959 3.9058847357093049446 1.5830179438357967481 5.6246343563238365704 -0.43172716485491952065 2.9980558641220365068;0.62320881910303027595 1.3571399790476317282 3.0493436087282566049 -4.5642342855479212105 0.014565630921285573421 0.79375884452417388992 -4.2543727788533871603 -2.717259573404596118 0.044549102768087205095 -2.3263390896263826946;3.1953780780443619136 -5.9981055565843020005 1.8950033135709165588 -0.114194777356377411 4.0090649201039409988 3.8495033561869842487 -2.4615060353912499025 -2.04877247694532727 5.1742165557967432221 4.2360358451420205839;3.4242924363383369091 -0.31455682829072290074 -1.4331501094048495482 -2.1186256718527056719 4.6940455225304473785 5.4723994290922473027 3.281830925257357201 -0.87313818708492607623 -0.77552887152856009312 -1.2867762842702215043;-2.1736070511138163575 1.789922407238106139 -2.6598366267003359376 1.2641411249735081679 0.049656492127184051477 -9.3823860958642146812 -1.6636838125255501986 2.1024493202565226468 1.114188056621528311 -0.47583515021193906191;-2.1023571539996375179 2.1458117004709391651 -0.65264148572320190844 -3.6311181659488114271 -5.6509690063527511228 1.2852367536524058611 -4.0304160321122335375 1.0081840129710366583 1.3260924703016212511 0.17614628463346795884;-0.53149232425053172246 1.1986225056532671118 -1.1070095689132355421 1.1071639376765871621 -0.5289761222584171696 -2.0868145563696334222 2.9637920141846847422 -2.9195698665754630241 -0.29805815135075741651 -1.5202808744512481542;-4.9366091386829058507 2.4009089025046690402 -3.855330888586723681 -2.5990268577799628957 2.72728779639444463 -1.0812392809681756756 0.78085587796253541626 -0.24740020470224327598 0.2509525423547828149 0.49377745770859332586;-0.49590979582898903066 0.026308802323289699754 -0.89923862402309251429 0.20266861151239115579 1.7628117926473405586 -2.5795302462807105925 0.48774444510116760076 -0.37072329051576130565 0.85156126602179904594 1.7679429204744121495;2.0343281992367607813 -0.99600986021468496112 1.1743967804275683431 0.47055477373785697948 2.2694247395661051314 -2.721386984877646853 -3.228891331276110499 2.1995395814325373607 0.47775279507543544355 -0.58881139825444017699;0.39548001049178910238 -0.27570430116017607958 0.56969237941030703709 -0.9140724097975945206 0.21220031952858212088 2.373815002997324175 2.3807311572819767065 -1.1951371152625436256 -0.72793254115388394965 -0.35104956673837356407;3.1199068816843373853 -1.0668646581520739858 2.1981280068474355893 1.3960680727343210972 2.6900721374447265077 4.7689374186058524074 -3.3616198242325645573 2.7456222172831039607 1.1180868176591762797 1.7746534459685083807;-1.1483566478218034668 0.96090921576394050518 2.3532880841633052604 1.3084305968685820964 -1.7843535524381517465 3.4004040271603899193 -1.7319687767979321524 -1.8905540268462843745 3.5649343833469653298 -1.4345309586266223878;0.41785673454887811706 -0.69221768108085746096 3.7223085422217225826 1.5674730572327559841 5.797660968635767631 -0.26025763855134470548 1.2904383069275187079 1.8402401030378381375 1.0757569299510758576 1.6855460341874175523;-4.8564004019035724724 0.24653262339275505699 0.12894572114352620407 1.3307473186763409956 3.5575518041790110679 2.170181861447326277 2.2342071741498767956 -2.2413796220542656634 4.383892573313074692 4.3246434596859177901;-0.98291587758804854769 0.066425776481181489364 -5.4022080810038746179 1.3191424328215706208 4.2124682388316987414 4.4249352494477127706 5.0095111728345695923 -1.5548017027746690033 -0.37805438284052139686 4.8177210458000461202;-2.2216846110755414934 -2.2345011248281125837 2.6023617822353801721 2.5185712511621929366 0.82191315963931499411 0.80154163010835022263 1.3206587900440778238 -2.6555762202637693825 2.4088233934756653198 -1.5954755961226132488;2.0422667580398354836 2.4578413864704673486 7.0504490262294821079 -1.7897199886626478094 -2.702463640403565126 -1.1351125798811088075 -0.84449558230292598449 1.5136466361743914355 -0.910194671810417133 -0.78312124731636312269;0.29613941787864178634 -0.77656842092123112842 0.83372137758280617792 1.4157635291348480422 0.4894639730351402207 1.5827207394252578165 0.97983184639596454524 2.167918881425276556 -2.7624211462388394978 -1.4615716508373157723;-1.3354568195423275334 0.60807193813962800988 2.643226535065652083 -0.815971770794119311 -4.3006627929162819512 0.056375945069326437176 -1.4885694135855849218 -1.1948644719364718281 0.99946366239997785907 2.745711851843354534;-0.77963407079978397363 0.48592667542029588379 1.8187006832400607337 -1.4828818035124169405 1.7877241861367583198 -6.1104816891919515598 -3.717438966641457565 0.23835564380306623056 3.3361353730291245512 1.2906150166950287606;0.66903788272093533962 -2.3409225021429804769 -0.21679829856240506736 2.2942098809215232258 0.38316788314875999122 8.488638198265896051 -2.8822310793139567231 1.2708999740482154195 1.9004797038079968008 4.0985435964164356193;0.03816212591890916217 -2.3785318955213305969 1.8110378720843560707 -0.0075290561743127405736 -3.0888713053480221227 -3.2595148483965070696 -3.8788133554589285801 3.3564283927732452284 1.0711628015885885645 -2.2455422244346503469;0.84138824938514467089 0.87519252177160833384 0.53645053067379544487 -0.028284674849720619488 -0.49475605528390809162 -7.1779585874143707613 0.67118867965801376485 -0.6589325806535242247 0.64964289897668159313 -0.76347808871796207786;4.0099418243134667961 1.6852413178452307907 -2.4125166460076532537 -0.15774842784074250002 -1.6835356139326416169 1.5569048428360292569 1.1113160746217813912 -3.9028092990726026557 4.6029707256626331002 2.9727244364590381664;-0.42850138729494791079 2.7933636575376401545 -1.599480604489006863 0.57160126110661724219 6.3267434239329469747 -3.8804294502141787326 5.4531968036959792556 -3.4655540117028218461 -1.3073747600827203552 3.4094419203041197441;3.6228869551277007588 0.85426981809294622039 -0.13909773520047480355 0.086444050268872502096 3.8219168560797149858 -1.6515647404502240558 3.1459689743139636064 -2.9587515955348808738 -1.515878796054211719 -5.3143146813869783784;1.4529544615480336489 -0.88572935103071126495 0.96049966246265361391 3.8479368437469281261 -0.65504863250778377903 7.228813452726064348 -0.093465388084307529648 4.4990665480516183194 2.1623075828609157334 4.5089351707407336889;-0.68552257639643210396 1.2062615114076238321 2.8128908665349867668 1.8141881052687764964 1.9750792019331777638 -8.9381727008364517673 -2.4407811566752761756 2.0917436974351608647 -3.1179069302782793649 -2.0214118347818113008;0.91073821581289893246 0.21858700427263891286 -0.073702114233403379084 -0.024958548151404941207 -0.26369092970741836446 -3.0416688087979304456 -0.23783374939597304309 -0.038599326389713160823 0.18269814849885082642 -0.46723984672586010847;-0.5757471362171998619 -0.13058803157840428999 0.17941828123602929224 -0.093276135990000216824 0.71869029871853795655 2.2780909961049014001 0.4545446548138254439 0.10470896275458389801 -0.36792901815819056832 0.25649811063619876172;-3.788013784035912046 -0.50670161739182184579 -0.010568950897324087129 -0.88365977961595532086 2.3065216623077056113 5.4285824201735310979 0.72353334522978507426 -5.9225352888621056735 -1.2648521356448316766 0.28829287472352893573;-2.3745246002392956797 -0.72408393596697095962 1.8689835638540450713 1.0783219630209246453 2.2625155179551597051 2.8733710171392177202 11.536320549882038478 -0.76518421548840209745 -0.46920297564373508736 -3.1183792565874575153;-2.4367097877489518609 3.7188669836978656136 -1.3186592931584719679 0.99051294659164890177 2.5889401679706782744 -3.4670185316818469268 3.1851401721807710565 0.75584021694763847687 -0.75435938410885594596 2.1710505405961484371;0.68106993689102723888 0.57587659381133105008 1.5585121668001096218 0.20880715193115917394 -2.9000266258679530118 -2.981806102561748606 -1.3953286678973697565 -0.37705340349169580438 -1.4683691937760878776 1.1374804372602007607;-1.9745527663287321118 3.1812567488631118273 0.75113825373405362917 1.3827839701575008746 0.33416835174504078143 -1.5841394992167803224 3.3115433349673222274 -4.9581307121381321679 2.5387944271688067666 -3.9087249119269880104;-0.64720986735981744786 0.013978290499260559096 -0.36269134877537123618 -0.15470353398872585537 2.2213687558822603485 0.66566504765412559674 0.57398007608213952313 0.062092131928576446698 -1.5400520427722874661 0.31008446328997962826;0.23418983010421418056 2.3383420092130644541 -1.1837805390835332009 -0.25133010751201240174 0.83948431652455779428 3.1709124198377827142 1.2039679912489500424 2.3061106949879657257 1.9739177888110392978 2.1360259502156737632;0.10328974545151287101 0.10577150051795282393 -0.26615450718252881002 0.08119506542477826494 -1.4851357654719254953 2.6473438014374592875 -0.58639624325729511334 -0.23283660053019869518 0.60060069446536412663 -0.49372542975913241703;1.1005746481191671649 -1.4003746590910646219 -0.68306188883479412866 -0.60334206366409537381 -2.6755713901198179272 -6.0418400488381589497 3.3621592645196107796 0.86324690098653877879 -8.5454470632571446487 -1.8853737832492767357;0.27927903581334195815 1.9884088683577865186 -2.7787433284511826592 -5.2648259138472086605 1.6268825112600155958 8.3585452807503397565 -5.2540403466942420252 3.5171414215160741179 -3.0077171113817424697 1.750642280225071401;-0.42463299111189645174 0.6138014493671820615 1.1061858831545854365 0.26250393609618927204 -4.1646003757384537636 -0.91614560065724581772 -0.13367706821360184066 -5.6723281687771383019 -2.2321995341638727339 3.1354748598151775951;-3.0226726922545235077 2.6493398845952227383 -2.2966032471172610485 0.60045927282665179092 0.77204463266668965638 4.0559871710748662821 4.6527629502150249508 -5.0630397239101352369 -0.84514895228599484778 -2.1447029613986727803;-3.9910341483596334378 -5.3611535124755658188 1.8682683451359483051 0.18022979145451437089 -5.2981311772615926614 -11.850260541491755006 -0.75486940975570360202 -3.1295721365341369058 -0.48072716334376480729 -4.1118478791034611675;3.3366598645871037299 4.0264671359605541667 2.1890129425590703072 -0.72710232944844821468 -1.4658619330424524918 -0.58313140851301303869 -1.520751598234028279 -1.862707648294223306 0.40374204216559178571 -1.8213303742902862137;-0.99121128204721886679 -4.2901196499370248816 -2.7023102153372189349 -0.50154237536135604092 -2.2998332786262083438 -2.7078266569985900425 0.38340855918896121768 -1.6664048471228081194 1.3581500216302073714 -0.18198546790158939834;-1.1626957705266396381 0.68752206952668948325 2.3891584538471826171 1.1131375086728925172 -0.98841719776157377364 10.140261879980821291 3.3182674583120519429 -2.2480763011152369302 -0.96350633925541462332 -0.36721848511815979865;-0.43259136051512209198 -2.6641078385133196704 -1.6501495781200459234 -0.53500547054578162509 -0.97906757723619042277 6.9101187627286506654 0.91627566273907146144 0.1319012902359540107 -1.7824487217907876158 0.74012502580400341134;-0.046303838487605331053 0.14872075873962797843 -0.56508654764370003232 0.77309269678690195615 1.0029227365910247105 -5.528343612798645168 0.63918246260668576397 -0.82591614804755941748 0.19282155836015812955 1.7088722493088137622;2.9360889574497961441 -0.70143779329571176451 -2.4828061004750847651 1.2995344929857326477 -1.5555063800705808408 -5.1746276040111434114 3.6745354481859791029 -3.4423564087805154088 -1.5284740802208196531 -2.3027868826091095755;1.3929368857389166081 1.3117506130272149623 -3.4588148382586330065 -0.34922555589847698032 -2.2284650926799280946 4.4622517525542901851 -1.227055148960610742 -0.55989796954027037934 -1.2193651022536837747 1.0627978964869888578;1.0564684237345178808 -0.30018074763458429954 -0.5467419406279930838 0.60734286552247218616 1.8097526094415525844 11.305580849176022795 4.3574925904449672842 -0.72923382065896269477 -2.1203932609458009395 1.7117161264635043505;-1.8354832558877962612 -5.2479556771836168849 2.3347381277871774863 1.6773422565385158745 -0.38993220174254344945 6.5861673738970507586 4.9191846816224416017 2.7330025336337704367 -4.8454116643913360818 0.84430280270782465113;-0.87597719445335175958 -1.0179093424058600625 0.94135422692181325299 0.19513060932969511496 -1.5440886982001427175 1.9567751070544547876 2.4562161863273566098 -3.0664873115689328387 1.5604077111659824251 -4.6763058163294699554;-0.94401007567920836028 -0.34916634422659703629 -0.24874527838017854164 0.29958939923594191113 0.29669893583029077755 -3.8103833408983449615 0.36556915331010447767 -0.13815258619622380887 0.32898151954123672214 0.14274699975688087683;-3.2081701547495389271 1.3343347356680148597 -2.0872924254819764656 0.37736913509331149186 -6.2719755021508847292 -2.6377848602260778321 1.8656440767768911471 -1.8799530975988507642 -2.3884261373252790861 0.41137998560424782202;1.1728112577282374662 0.74463124229172006352 -0.41063736925101496089 -0.0079682141721424439018 1.5159333836334691892 -0.70873325926395414065 -0.13483949812241693977 0.84333098622025026714 3.2540053747319626076 -2.3940944101411583134;-0.24385717726663319604 0.15711204371963083393 0.51224786845836756122 2.2681986118258490315 -3.6878647223392033716 7.1024433988076864921 -2.593044670033808341 -0.55713627733822135291 -2.6315205323167369933 -2.8635273180241616053;2.0591964426317428405 -0.98686090877994081527 1.1466489621145854461 0.55568776413995435437 2.3710597951013818729 -2.8614854067315245167 -3.224293021862917108 2.1951381737189530341 0.47204030242637190495 -0.65379678362145510206;0.8537058711404081901 1.7508517252475244153 1.9990777224028737358 -0.88855730174921410125 -2.232425003507734651 6.0086816323536611506 -1.4108141769435520452 -0.61158399012811581752 1.4043822002656141112 -0.57358415965390707747;-2.98437895400719988 -6.5706626524233309183 -1.2331820439141834012 4.4567618931176564701 5.2323014351256205146 -5.9921457518514404939 -4.5096653715722716527 2.8331039339826729062 -2.3343267487597887389 1.809777360294208215;-3.3856875194438935672 -4.6485530993415720147 -2.5009473733714639998 3.360145916247167186 -0.79857351595756687068 3.7475917454016651753 -3.3955614991000584446 -6.1973830236125841964 -3.8636695430371683635 8.2348149010327027497;3.3599282753758208386 4.061782477419046522 2.1958784198961560641 -0.72512876984451046791 -1.444282659640101496 -1.1386116523481912832 -1.5392358491677442522 -1.8731302464581165435 0.41819075840319769322 -1.8565468581904989165;-1.636195670547125669 -4.4155275063983392414 4.4805122169949473943 -2.5862207282439553246 0.12149641701901048307 0.1361795355428179477 0.56032211132211418025 -1.4777356868247801813 2.8754617443339083316 -1.6206224970669025343;0.57069296831522309255 0.008964831826405764495 0.41865987400419357733 -0.17644528793576372272 1.5154900194325973128 0.58965111944488779461 2.2676488599595652218 -0.5936645197869027113 -0.66217685605383125313 0.71801454805246633928;-0.9481794175140633163 -0.22996731893909364008 0.0758033657862846183 0.064607900225154127338 0.072324278301989078366 3.7831590117692943664 0.2168041128290325581 -0.022582483390364574416 -0.05844863802402282954 0.56647106193267260377;-0.98808314705863808936 0.50168589166390598066 0.33086413001875297768 -1.5030158725584323864 1.5560411450784623622 -3.6471167643919337742 -2.6064334184551389839 -0.93290241384849759143 3.7103501527943549831 0.28776793620007251606;-0.046227569412934724213 1.5358722132615469924 0.70128505521169748338 -0.64792772538119958181 -2.0049640195846603064 4.6056697368796761793 -2.1244864864821018102 -0.16013204494060362393 -1.4461886897763422954 0.60960860997300514441;-1.8079820833404034452 1.6393577606356348753 -3.3032291988402495697 -1.4764771514329395607 4.8080838878780545187 5.9858377866582923588 2.0904917895530812366 1.0795865264532109595 4.1235043012847611976 -4.6343626073779162766;0.84912646427317284292 -0.52948061837249416062 0.13386873034171153929 -3.8325155780213435719 -6.5093081978245326269 -1.9716997082545890674 -0.97955633333009428654 -0.14835666245318038237 0.40385692617692797723 4.7753976574216503437;-4.2827376329888062756 0.032764409262461692551 6.6244575332705757376 -2.4777056586547638872 -0.19516034031224741008 2.5932703708678910282 5.4047487973130969863 -1.6942169323304521189 -1.622699690175321896 -0.028408374351663906454;0.58199611581720078757 0.71406615488025815264 0.21761549691452239386 1.0301429996572744052 -1.9764839182456288569 -0.64049922236412126786 1.2190108531124910218 -7.5153225055962851187 3.3818099768755094381 0.67458751681986162119;-3.4203430649395838437 6.8610430700385762748 -2.1115063615240012851 -0.95978727528210872055 4.4071543974740263749 13.525548099599026486 6.4162038352330821311 1.3727038434643410447 -5.0459944180479583409 -2.3921460414872846023;0.5612279216547911842 0.29985083625157027409 -2.5984603013269800265 -1.1268364337821692445 0.81392013481971281497 -4.1750472881810178905 -2.4321926073362907239 -1.0226053077537222702 6.3818811746127943607 0.43543143571838610617;-2.7806874395018827961 -2.0136044396374841448 -0.91633954046433496732 1.6824716219960735852 -2.7957361134281728532 -0.59009983612483685178 -2.836479164591219071 -3.4682792944449638561 -0.30991492193580744141 -0.68144769422047013485;1.0940942075975059744 -0.62349580157969941574 0.013979423567244030763 0.94577919876577876135 0.67129775907798527879 -1.1550013822921627593 -1.7137027061959899665 1.3387728959820754948 1.19616459969549771 -0.16732116783835065954;-0.019557381334979549725 2.1010182869489164581 -1.7227398311995023583 1.5517549011733648978 -0.24803959410478221281 -5.7926635651587794484 3.3982753982078275357 -3.3526026778424178332 -1.1876884178947932913 -2.1611533219650165272;-1.7204816962220743637 1.4805396136726285405 0.27876641530103335453 3.876433751446369147 4.8998754918006239834 1.3193442616360653297 -1.8683384775545082146 -0.32878933950599165126 0.92734778078634017007 -0.19174322405971178096;0.56449922869514690404 0.007636510181244404033 0.44236913435051422594 -0.17910545259948074115 1.627995464995825925 0.15833058023296131545 2.2302608672305024307 -0.58231767651571497701 -0.62133077784270618338 0.72807838562998516974;1.7588838441801926127 0.31224777592331970366 0.58108197783889148358 0.13661862587001591396 1.2321729728299355422 3.5700420338160667733 -5.4950941230438843377 2.0138421637216188387 1.6817921238228277225 1.2393256626188686731;-2.6612924171178606869 0.70612356013209887085 -0.39775247852406292459 -0.034732226126545855116 -4.5546853398490618758 -2.86533284452721837 -3.7904561386761530528 2.493390206107712892 -0.21765432860844938223 1.4831561091673612918;0.45609772690568450848 -0.38879081888534627875 0.30092047557863543794 -1.2804750917526479537 1.4601949956649402651 -2.0947943458228919233 2.3086553313348279204 1.8359595116191780306 -2.197084010681839672 2.897646881874746061;-4.537586815133395568 -1.3087201178396432599 1.5385846322068321701 -0.44683734189537677173 3.335173963461686153 -0.072439144532095059437 -0.73771965837455244497 2.4246538704232150074 -0.68465109124787326689 -1.4360234380167962165;-1.9165898290437459739 -0.49765726905129026303 3.5583941211527627679 1.6211264441527035718 4.4355845350627571833 -4.7109130629759858877 -0.051530084517838116442 -2.0999627295328915366 0.86474384537029058695 -0.28278023223704396028;0.18725506721516188557 0.92793183154233394028 -0.8295165342084660498 0.3636661794263516545 -0.49535974553106121299 -0.34853600904032144836 1.5286286259221200101 -1.5189256004343592021 -0.48360097783592226328 -1.4075446998894269868;3.4942785289507796165 3.71133617613163036 -2.649317913771376265 2.6577098683917008692 2.1713674904453235115 -0.04420932182829256929 0.90147954143128117277 -1.7922032763874862216 0.52552035169533350967 -4.8758900967677707428;-0.60494580403655673351 -0.29769117226376673457 2.9288263660233218033 -0.77143373519010338679 1.5904367134460837274 -2.9105830960098888482 4.4424875445183618083 4.644980544645822107 1.8381930053719937046 -2.3478283020511883095;-2.9135707804145276612 -0.22861778859811332509 -0.058663207492986368941 0.61877607510792731471 -2.5629954166584272279 5.3876517542039863429 -2.1505574275429548692 1.4241072118101363309 1.1374479915262027951 1.4461746119959510981;-2.465399005347298278 -0.23187686298427076514 2.1351393802363518581 -0.68556034145459032736 -1.3303217622616507754 10.341259686460785971 1.2009650695751068472 1.5625946174064986316 -0.61889244281323041452 2.9308661845782162381;0.44996285783191075636 -0.96768536639250068987 1.1496592073905043119 -1.2127380777625520469 0.17645059493421955121 4.7250134099768112961 2.1393096123122110619 -1.0589817221406736536 0.25397172470866757887 3.9892031036368771346;-2.8261720549508764222 1.089244216989819769 3.3426231736330294098 1.4785767552334716513 -0.20016401940493405709 -3.4014191865211840238 5.4009267104705394047 -3.2426884710747678753 -3.4755527091265627782 -2.0971346347274923971;-3.8083892184830441252 8.1474528298641768487 3.7040872137532887542 -1.899839475283656931 -0.3148374049306097433 -2.4451606871548992039 -1.4824295405738854292 0.31372584379764806295 1.6800453241403523474 0.77523027924614107409;2.2014616787394065689 -3.8397930292892166193 5.8491568529287105704 2.7856346650240109142 -0.49199159634913436356 -3.6898548340113093147 -2.1988428260850358953 0.2846430783862292091 1.4567654230026589879 2.7085970291749146277;0.96811632994865282065 -0.40944668778117926378 -0.57346813779569105751 -0.11446023785572027875 -0.1505405936198301875 2.3551286445487824572 1.1986281528720190703 -0.21358046176507120006 -0.019148256042487783041 -0.066947524484861908878;2.6306356273091799913 -1.5045455800976257343 0.65607087983002154719 -3.4749399800144074035 0.80048081865972975368 -10.824269431833764443 -3.7086153464697106941 0.55292930249909666429 1.3765989209869016197 -1.8171178276725996614;0.82039631860412598474 1.7996412076422589887 3.3707279832704508671 -0.65040044656752882268 -0.20410466276599625868 -6.3506941925367375035 -1.9729462198255245386 1.4606386360556851134 0.74656938175793996493 -0.68114747847227941069;4.8330221724582633769 -0.67238335844105789896 -0.6079957067104397872 -1.328273788837163405 1.3921312579765823259 -3.7890056520489903136 -0.83599830133453079117 -0.65316623585555233511 0.15478421861880084509 -1.8278487283462725443];

% Layer 2
b2 = -6.4228154703815452109;
LW2_1 = [-0.016945406896085261211 -0.0023055046969962709157 0.015553288245955417674 0.01841770257412747927 0.0092924194635706537648 -0.00082798353861039360787 -0.00046740662783851475576 0.0046627824065806145262 0.046607906218207775795 -0.0069722310623144927166 -0.0061402683777663910267 -0.03209842085164189146 0.011811188162746408606 -0.083796291402218198163 -0.0017838905319689443707 0.14031801484020747783 -2.3984361258592241661 -0.0023155070555193018982 0.02377344661985696106 -0.068328037478968414731 0.0051115888020153536775 -0.091056976808100431597 0.27477087634666602645 0.016085941004635041784 -0.0038341352624104633844 -0.0084465577613771214427 0.005575639650422358623 0.026257068407372498309 -0.029638412236980979375 -0.0020767166190877790234 0.01626816949535459314 0.0032451224396871582341 0.0013281909068781935605 -0.0018894862236615379749 -0.0069778547342975814211 -0.0097821720469849059859 -0.0081599539451121128747 -0.032528468888019954064 0.0099985824724834349714 -0.095103459622293246012 0.71774060675514672614 -0.039029019345330415169 0.017130559406860455113 0.0047353977349104932684 -0.0029844170423802851046 -0.0037978919043785536701 -0.0077005156966009459876 -0.0052127092793091290429 -0.0040886007085642172426 -0.01320817808769239772 0.0055548594053029844153 0.0069431317155270524943 0.0083520859363561596872 -0.022004889403274701526 -0.062921209160958793682 0.0067702538330589590032 -0.016173210057680381668 -0.015631074769068734054 0.0034837027987668100527 -0.039495713092547977963 1.4151071174630664995 0.77195163957922752207 0.0024099540490902433311 0.0026226236770526220078 0.014142136632376229102 0.016717813810732631841 -0.0080539259072118056515 -0.064231650923532321307 0.0032496234907681159111 0.36591779638130506047 0.0029100837999079271629 0.0020109261344811763146 -0.0034473246600874789085 0.0084948699095739599318 0.0023781112573435709591 -0.62682521349920705678 0.007814310260553099588 -0.0061153475069016440674 -0.014286917152537487521 0.043058167744208730721 -0.008672481126872097143 -0.013105159090407337771 -0.038429403054467299594 -0.001796722747410548545 -0.090231998331954804682 0.350845229898488431 -0.0041228246257821454801 0.010398489366519185137 -0.013840191676617622993 -0.6772213286771483487 0.017358551947422810185 0.0039953303965218622817 0.00096018889969489470537 0.61868032605361389376 -0.0036907326868779845655 -2.949222960209022304 0.86668845445143827266 0.010657034123699483941 0.019245408274556723149 0.0047719011618381317053 -0.004695468018908333617 0.0031397648603420777111 0.010454767221287439988 -0.0041269942742660206333 -0.0097838521153542756109 0.0068136913836763114 -0.028406210612094758006 -0.025301413179318686664 -0.0038175745613155099255 2.7148965713027157776 0.80092962495797070943 -0.015742035020425110964 -5.5272976897341310476 -0.0056065240863308650823 0.0058581244970982385839 0.1674545918561817226 0.0070895576571569588614 -0.0018407238281543758605 -0.0312122945857204806 0.0092808847713431175119 -0.017872200398357081241 -0.0053608066733547470387 -0.0039457145576763438116 -0.0047784709464745826757 0.077250135940147679481 0.0059453113520624729232 0.03609192304877097135 0.0079019254511954375303];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00104453914932732;
y1_step1.xoffset = 723.5;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
%y1=y1.*x1(SAL,:)./35;
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
